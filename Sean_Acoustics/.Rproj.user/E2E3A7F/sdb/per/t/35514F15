{
    "collab_server" : "",
    "contents" : "---\ntitle: \"KI Fish Acoustics - Exploratory Plots\"\nauthor: \"Sean Dimoff\"\ndate: \"`r format(Sys.time(), '%B %d, %Y')`\"\noutput:\n  html_document:\n    toc: true\n    toc_float: true\n    toc_depth: 2\n---\n\nSummary plots for the 2017 and 2018 Kiritimati reef fish survey data at 5 acoustic sites\n\n```{r setup, include = FALSE}\n## Load data (CHANGE TO MY DATA EXPORTED BY THE CLEANING)\n#load(\"../Data/KI_UVC_13_15_17_trans.Rdata\")\n#load(\"../Data/KI_UVC_13_15_17.Rdata\")\n#load(\"../Data/KI_UVC_13_15_17_BM_trans.Rdata\")\nload(\"C:/Users/Sdimo/Documents/GitHub/ki-fish/Sean_Acoustics/KI_UVC_17_18.Rdata\")\nload(\"C:/Users/Sdimo/Documents/GitHub/ki-fish/Sean_Acoustics/KI_UVC_17_18_obs_sum.Rdata\")\nload(\"C:/Users/Sdimo/Documents/GitHub/ki-fish/Sean_Acoustics/KI_UVC_17_18_obs_herb_sum.Rdata\")\nlibrary(here)\n\n## Load necessary packages\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n## Set theme for plots\ntheme_set(theme_bw() + theme(plot.title = element_text(hjust = 0.5)) + \n            theme(axis.text.x = element_text(size = 14, color = \"black\"), \n                 axis.text.y = element_text(size = 14, color = \"black\"), \n                 axis.ticks = element_blank(),\n                 axis.title.y = element_text(size = 17, margin = margin(0,20,0,0)),\n                 axis.title.x = element_text(size = 17, margin = margin(20,0,0,0)),\n                 plot.title = element_text(size = 20, margin = margin(0,0,15,0)),\n                 plot.margin = margin(10,10,10,20), \n                 strip.background = element_rect(fill = \"black\"),\n                 strip.text = element_text(colour = \"white\", size = 12),\n                 panel.border = element_rect(color = \"black\", fill = NA, size = 1),\n                 panel.grid.major = element_blank(), panel.grid.minor = element_blank()))\n\n## Find which sites are present at each time point\n#sites_13 <- unique(ki_fish$Site[ki_fish$Year == \"2013\"])\n#sites_15 <- unique(ki_fish$Site[ki_fish$Year == \"2015\"])\n#sites_17 <- unique(ki_fish$Site[ki_fish$Year == \"2017\"])\n\n\n# Sites surveyed before/during the El Nino\n#sites_BD <- intersect(sites_13, sites_15)\n# Sites surveyed before/after the El Nino\n#sites_BA <- intersect(sites_13, sites_17)\n# Sites surveyed in all three time points\n#sites_BDA <- Reduce(intersect, list(sites_13, sites_15, sites_17))\n\n\n#Filter for only my 5 hydrophone sites\nfsites.to.keep <- c(5,35,8,40,32)\nfish.ac <- ki_fish[ki_fish$Site%in%fsites.to.keep,]\nfish.ac <- droplevels(fish.ac)\n\nki_hfish.ac <- ki_hfish[ki_hfish$Site%in%fsites.to.keep,]\nki_hfish.ac <- droplevels(ki_hfish.ac)\n\nki_full.ac <- ki_full[ki_full$Site%in%fsites.to.keep,]\nki_full.ac <- droplevels(ki_full.ac)\n\n#create one dataframe for each of my 5 sites\nsite5 <- c(5)\nsite8 <- c(8)\nsite32 <- c(32)\nsite35 <- c(35)\nsite40 <- c(40)\n\nki.5 <- ki_full.ac[ki_full.ac$Site%in%site5,]\nki.5 <- droplevels(ki.5)\nki.8 <- ki_full.ac[ki_full.ac$Site%in%site8,]\nki.8 <- droplevels(ki.8)\nki.32 <- ki_full.ac[ki_full.ac$Site%in%site32,]\nki.32 <- droplevels(ki.32)\nki.35 <- ki_full.ac[ki_full.ac$Site%in%site35,]\nki.35 <- droplevels(ki.35)\nki.40 <- ki_full.ac[ki_full.ac$Site%in%site40,]\nki.40 <- droplevels(ki.40)\n\n#Grouping and summarizing each site by species abundance\nki.5abo <- ki.5 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\nki.5ab <- ki.5 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\n\nki.8abo <- ki.8 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\nki.8ab <- ki.8 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\n\nki.32abo <- ki.32 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\nki.32ab <- ki.32 %>% group_by(Year, Site, Species, Family, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\n\nki.35abo <- ki.35 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\nki.35ab <- ki.35 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\n\nki.40abo <- ki.40 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\nki.40ab <- ki.40 %>% group_by(Year, Site, Species, Family, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))\n\n#pulling excavators for some sites\nExcavators <- c(\"Excavator\", \"Scraper\")\nki.32ex <- ki.32ab[ki.32ab$FineFG%in%Excavators,]\nki.35ex <- ki.35ab[ki.35ab$FineFG%in%Excavators,]\nki.40ex <- ki.40ab[ki.40ab$FineFG%in%Excavators,]\n\n## Filter for sites present in all years\n#ki_fish <- filter(ki_fish, Site %in% sites_BDA)\n#ki_fish_BM <- filter(ki_fish_BM, Site %in% sites_BDA)\n\n## Order human disturbance levels\nlevels(fish.ac$f.pressure)\nfish.ac$f.pressure <- factor(fish.ac$f.pressure, levels(factor(fish.ac$f.pressure))[c(5,2,3,1,4)])\n\n\n\n#levels(ki_fish_BM$f.pressure)\n#ki_fish_BM$f.pressure <- factor(ki_fish_BM$f.pressure, #levels(factor(ki_fish_BM$f.pressure))[c(5,2,3,1,4)])\n\n## Order sites for plotting (WILL NEED TO CHANGE TO MY 5 SITES)\nlevels(fish.ac$Site)\nfish.ac$Site <- factor(fish.ac$Site, levels(factor(fish.ac$Site))[c(1,2,4,3,5)])\n\n\n#levels(ki_fish_BM$Site)\n#ki_fish_BM$Site <- factor(ki_fish_BM$Site, #levels(factor(ki_fish_BM$Site))[c(4,5,7,10,1,11,3,6,13,12,2,8,9)])\n#ki_fish_BM$Site <- factor(ki_fish_BM$Site, levels(factor(ki_fish_BM$Site))[c(8,3,11,1,2,10,9,5,7,12,13,4,6)])\n```\n\n\n# Total Abundance\n## All Fish\n\n```{r RF_AB, echo = FALSE}\np1 <- ggplot(fish.ac, aes(Site, AB_total)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np1 <- p1 + xlab(\"Site\") + ylab(\"Mean Abundance\") + labs(title = \"Total Fish Abundance\")\np1 <- p1 + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\np1\n\np1b <- ggplot(fish.ac, aes(Year, AB_total)) + geom_boxplot(aes(fill = Year))\np1b <- p1b + xlab(\"Year\") + ylab(\"Mean Abundance\") + labs(title = \"Total Fish Abundance\")\np1b <- p1b + guides(fill = FALSE) + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\n#p1b <- p1b + ylim(0,3000)\np1b\n\np1c <- ggplot(fish.ac, aes(f.pressure, AB_total)) + geom_boxplot(aes(fill = f.pressure))\np1c <- p1c + xlab(\"Human Disturbance\") + ylab(\"Mean Abundance\") + labs(title = \"Total Fish Abundance\")\np1c <- p1c +guides(fill = FALSE) + scale_fill_manual(values = c(\"#01665E\", \"#80CDC1\", \"#DFC27D\", \"#BF812D\", \"#663300\"))\n#p1c <- p1c + ylim(0,3000)\np1c\n\np1d <- ggplot(ki.32ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np1d <- p1d + theme(axis.text.x = element_text(angle = 90, hjust = 0, size = 6))\np1d <- p1d + labs(title = \"Total Species Abundance at Site 32\")\np1d\n\np1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np1e <- p1e + theme(axis.text.x = element_text(angle = 90, hjust = 0, size = 8))\np1e <- p1e + labs(title = \"Total Species Abundance at Site 40\")\np1e\n```\n\n\n# Herbivore Fine Functional Group Abundance\n\n## Total Herbivores\n\n```{r RF_AB_herb, echo = FALSE}\np7 <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np7 <- p7 + xlab(\"Site\") + ylab(\"Mean Abundance\") + labs(title = \"Herbivore Abundance\")\np7 <- p7 + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\np7\n\np7b <- ggplot(fish.ac, aes(Year, AB_herb)) + geom_boxplot(aes(fill = Year))\np7b <- p7b + xlab(\"Year\") + ylab(\"Mean Abundance\") + labs(title = \"Herbivore Abundance\")\np7b <- p7b + guides(fill = FALSE) + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\np7b\n\n\np7c <- ggplot(fish.ac, aes(f.pressure, AB_herb)) + geom_boxplot(aes(fill = f.pressure))\np7c <- p7c + xlab(\"Human Disturbance\") + ylab(\"Mean Abundance\") + labs(title = \"Herbivore Abundance\")\np7c <- p7c + guides(fill = FALSE) + scale_fill_manual(values = c(\"#01665E\", \"#80CDC1\", \"#DFC27D\", \"#BF812D\", \"#663300\"))\np7c\n\np7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot(aes(fill = Year))\np7d <- p7d + xlab(\"Site\") + ylab(\"Mean Abundance\") + labs(title = \"Herbivore Abundance\")\np7d <- p7d + guides(fill = FALSE) + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\np7d\n```\n\n\n## Excavators\n```{r RF_AB_exc, echo = FALSE}\np8 <- ggplot(ki_hfish.ac, aes(Site, AB_exca)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np8 <- p8 + xlab(\"Site\") + ylab(\"Mean Abundance\") + labs(title = \"Excavator Abundance\")\np8 <- p8 + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\np8\n\np8b <- ggplot(ki_hfish.ac, aes(Year, AB_exca)) + geom_boxplot(aes(fill = Year))\np8b <- p8b + xlab(\"Year\") + ylab(\"Mean Abundance\") + labs(title = \"Excavator Abundance\")\np8b <- p8b + guides(fill = FALSE) + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\np8b\n\np8c <- ggplot(ki_hfish.ac, aes(f.pressure, AB_exca)) + geom_boxplot(aes(fill = f.pressure))\np8c <- p8c + xlab(\"Human Disturbance\") + ylab(\"Mean Abundance\") + labs(title = \"Excavator Abundance\")\np8c <- p8c + guides(fill = FALSE) + scale_fill_manual(values = c(\"#01665E\", \"#80CDC1\", \"#DFC27D\", \"#BF812D\", \"#663300\"))\np8c\n\np8d <- ggplot(ki.32ex, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np8d <- p8d + theme(axis.text.x = element_text(angle = 90, hjust = 1))\np8d <- p8d + labs(title = \"Site 32 Excavator Abundance\")\np8d\n\np8e <- ggplot(ki.35ex, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np8e <- p8e + theme(axis.text.x = element_text(angle = 90, hjust = 1))\np8e <- p8e + labs(title = \"Site 35 Excavator Abundance\")\np8e\n\np8f <- ggplot(ki.40ex, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np8f <- p8f + theme(axis.text.x = element_text(angle = 90, hjust = 1))\np8f <- p8f + labs(title = \"Site 40 Excavator Abundance\")\np8f\n\n```\n\n## Grazers\n```{r RF_AB_graz, echo = FALSE}\np9 <- ggplot(ki_hfish.ac, aes(Site, AB_graz)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np9 <- p9 + xlab(\"Site\") + ylab(\"Mean Abundance\") + labs(title = \"Grazer Abundance\")\np9 <- p9 + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\np9\n\np9b <- ggplot(ki_hfish.ac, aes(Year, AB_graz)) + geom_boxplot(aes(fill = Year))\np9b <- p9b + xlab(\"Year\") + ylab(\"Mean Abundance\") + labs(title = \"Grazer Abundance\")\np9b <- p9b + guides(fill = FALSE) + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\np9b\n\np9c <- ggplot(ki_hfish.ac, aes(f.pressure, AB_exca)) + geom_boxplot(aes(fill = f.pressure))\np9c <- p9c + xlab(\"Human Disturbance\") + ylab(\"Mean Abundance\") + labs(title = \"Grazer Abundance\")\np9c <- p9c + guides(fill = FALSE) + scale_fill_manual(values = c(\"#01665E\", \"#80CDC1\", \"#DFC27D\", \"#BF812D\", \"#663300\"))\np9c\n```\n\n\n## Browsers\n```{r RF_AB_brows, echo = FALSE}\np10 <- ggplot(ki_hfish.ac, aes(Site, AB_brows)) + geom_bar(aes(fill = Year), stat = \"identity\", position = \"dodge\")\np10 <- p10 + xlab(\"Site\") + ylab(\"Mean Abundance\") + labs(title = \"Browser Abundance\")\np10 <- p10 + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\np10\n\n#p9b <- ggplot(ki_hfish.ac, aes(Year, AB_graz)) + geom_boxplot(aes(fill = Year))\n#p9b <- p9b + xlab(\"Year\") + ylab(\"Mean Abundance\") + labs(title = \"Grazer Abundance\")\n#p9b <- p9b + guides(fill = FALSE) + scale_fill_manual(values = c(\"#3399CC\", \"#99CCFF\", \"#006699\"))\n#p9b\n\n#p9c <- ggplot(ki_hfish.ac, aes(f.pressure, AB_exca)) + geom_boxplot(aes(fill = f.pressure))\n#p9c <- p9c + xlab(\"Human Disturbance\") + ylab(\"Mean Abundance\") + labs(title = \"Grazer Abundance\")\n#p9c <- p9c + guides(fill = FALSE) + scale_fill_manual(values = c(\"#01665E\", \"#80CDC1\", \"#DFC27D\", \"#BF812D\", \"#663300\"))\n#p9c\n\n```\n",
    "created" : 1544556667679.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2852408530",
    "id" : "35514F15",
    "lastKnownWriteTime" : 1545249667,
    "last_content_update" : 1545249667697,
    "path" : "~/GitHub/Sean_Fish_Acoustics17-18/Sean_Acoustics/R_Scripts/KI_fish_explore_box_SD.Rmd",
    "project_path" : "R_Scripts/KI_fish_explore_box_SD.Rmd",
    "properties" : {
        "last_setup_crc32" : ""
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}