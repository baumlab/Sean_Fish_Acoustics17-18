p7b
ki_hfish.ac <- ki_hfish[ki_hfish$Site%in%fsites.to.keep,]
ki_hfish.ac <- droplevels(ki_hfish.ac)
p7a <- ggplot(ki_hfish.ac, aes(Site, AB_graz)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p7a <- p7 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Grazer Abundance")
#p7a <- p7a + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7a
p7b <- ggplot(ki_hfish.ac, aes(Site, AB_brows)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p7b <- p7b + xlab("Site") + ylab("Mean Abundance") + labs(title = "Browser Abundance")
#p7b <- p7b + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7b
p7c <- ggplot(ki_hfish.ac, aes(Site, AB_exca)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p7c <- p7c + xlab("Site") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
#p7c <- p7c + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7c
p7a <- p7 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Grazer Abundance")
p7a <- p7a + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7a
p7b <- ggplot(ki_hfish.ac, aes(Site, AB_brows)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p7b <- p7b + xlab("Site") + ylab("Mean Abundance") + labs(title = "Browser Abundance")
p7b <- p7b + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7b
p7c <- ggplot(ki_hfish.ac, aes(Site, AB_exca)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p7c <- p7c + xlab("Site") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p7c <- p7c + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7c
View(ki_hfish.ac)
knit_with_parameters('~/GitHub/ki-fish/Sean_Acoustics/R_Scripts/KI_fish_explore_box_SD.Rmd')
p1b <- ggplot(fish.ac, aes(Year, AB_total)) + geom_boxplot(aes(fill = Year))
p1b <- p1b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1b <- p1b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p1b <- p1b + ylim(0,3000)
p1b
p1c <- ggplot(fish.ac, aes(f.pressure, AB_total)) + geom_boxplot(aes(fill = f.pressure))
p1c <- p1c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1c <- p1c +guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
p1c <- p1c + ylim(0,3000)
p1c
load("C:/Users/Sdimo/Documents/GitHub/ki-fish/Sean_Acoustics/KI_UVC_17_18.Rdata")
load("C:/Users/Sdimo/Documents/GitHub/ki-fish/Sean_Acoustics/KI_UVC_17_18_obs_sum.Rdata")
load("C:/Users/Sdimo/Documents/GitHub/ki-fish/Sean_Acoustics/KI_UVC_17_18_obs_herb_sum.Rdata")
library(here)
library(dplyr)
library(RColorBrewer)
theme_set(theme_bw() + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.x = element_text(size = 14, color = "black"),
axis.text.y = element_text(size = 14, color = "black"),
axis.ticks = element_blank(),
axis.title.y = element_text(size = 17, margin = margin(0,20,0,0)),
axis.title.x = element_text(size = 17, margin = margin(20,0,0,0)),
plot.title = element_text(size = 20, margin = margin(0,0,15,0)),
plot.margin = margin(10,10,10,20),
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", size = 12),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.grid.major = element_blank(), panel.grid.minor = element_blank()))
theme_set(theme_bw() + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.x = element_text(size = 14, color = "black"),
axis.text.y = element_text(size = 14, color = "black"),
axis.ticks = element_blank(),
axis.title.y = element_text(size = 17, margin = margin(0,20,0,0)),
axis.title.x = element_text(size = 17, margin = margin(20,0,0,0)),
plot.title = element_text(size = 20, margin = margin(0,0,15,0)),
plot.margin = margin(10,10,10,20),
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", size = 12),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.grid.major = element_blank(), panel.grid.minor = element_blank()))
library(ggplot2)
theme_set(theme_bw() + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.x = element_text(size = 14, color = "black"),
axis.text.y = element_text(size = 14, color = "black"),
axis.ticks = element_blank(),
axis.title.y = element_text(size = 17, margin = margin(0,20,0,0)),
axis.title.x = element_text(size = 17, margin = margin(20,0,0,0)),
plot.title = element_text(size = 20, margin = margin(0,0,15,0)),
plot.margin = margin(10,10,10,20),
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", size = 12),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.grid.major = element_blank(), panel.grid.minor = element_blank()))
fsites.to.keep <- c(5,35,8,40,32)
fish.ac <- ki_fish[ki_fish$Site%in%fsites.to.keep,]
ki_hfish.ac <- ki_hfish[ki_hfish$Site%in%fsites.to.keep,]
ki_hfish.ac <- droplevels(ki_hfish.ac)
levels(fish.ac$Site)
p1 <- ggplot(fish.ac, aes(Site, AB_total)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1 <- p1 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p1
p1 <- ggplot(fish.ac, aes(Site, AB_total)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1 <- p1 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1 <- p1 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p1
p1b <- ggplot(fish.ac, aes(Year, AB_total)) + geom_boxplot(aes(fill = Year))
p1b <- p1b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1b <- p1b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p1b <- p1b + ylim(0,3000)
p1b
p1b <- ggplot(fish.ac, aes(Year, AB_total)) + geom_boxplot(aes(fill = Year))
p1b <- p1b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1b <- p1b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
#p1b <- p1b + ylim(0,3000)
p1b
p1c <- ggplot(fish.ac, aes(f.pressure, AB_total)) + geom_boxplot(aes(fill = f.pressure))
p1c <- p1c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1c <- p1c +guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
#p1c <- p1c + ylim(0,3000)
p1c
p7 <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p7 <- p7 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7 <- p7 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7
p7b <- ggplot(fish.ac, aes(Year, AB_herb)) + geom_boxplot(aes(fill = Year))
p7b <- p7b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7b <- p7b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7b
p7c <- ggplot(fish.ac, aes(f.pressure, AB_herb)) + geom_boxplot(aes(fill = f.pressure))
p7c <- p7c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7c <- p7c + guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
p7c
p7d <- ggplot(fish.ac, aes(Year, AB_herb)) + geom_boxplot(aes(fill = Year))
p7d <- p7b + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7d <- p7b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7d
p7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot(aes(fill = Year))
p7d <- p7b + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7d <- p7b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7d
p7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot(aes(fill = Site))
p7d <- p7b + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7d <- p7b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7d
p7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot(aes(fill = Year))
p7d <- p7b + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7d <- p7b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7d
p7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot(aes(fill = Year))
p7d <- p7b + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
#p7d <- p7b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7d
p7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot()
p7d <- p7b + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7d
View(fish.ac)
p7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot(aes(fill = Year))
p7d
p7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot(aes(fill = Year))
p7d <- p7b + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7d <- p7b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7d
p7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot(aes(fill = Year))
p7d <- p7d + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7d <- p7b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7d
p7d <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_boxplot(aes(fill = Year))
p7d <- p7d + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7d <- p7d + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7d
p8 <- ggplot(ki_hfish.ac, aes(Site, AB_exca)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p8 <- p8 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8 <- p8 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p8
p8b <- ggplot(ki_hfish.ac, aes(Year, AB_exca)) + geom_boxplot(aes(fill = Year))
p8b <- p8b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8b <- p8b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p8b
p8c <- ggplot(fish.ac, aes(f.pressure, AB_exca)) + geom_boxplot(aes(fill = f.pressure))
p8c <- p8c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8c <- p8c + guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
p8c
View(ki_hfish.ac)
p8c <- ggplot(ki_hfish.ac, aes(f.pressure, AB_exca)) + geom_boxplot(aes(fill = f.pressure))
p8c <- p8c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8c <- p8c + guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
p8c
p8 <- ggplot(ki_hfish.ac, aes(Site, AB_exca)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p8 <- p8 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8 <- p8 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p8
p8b <- ggplot(ki_hfish.ac, aes(Year, AB_exca)) + geom_boxplot(aes(fill = Year))
p8b <- p8b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8b <- p8b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p8b
p8c <- ggplot(ki_hfish.ac, aes(f.pressure, AB_exca)) + geom_boxplot(aes(fill = f.pressure))
p8c <- p8c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8c <- p8c + guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
p8c
p8d <- ggplot(ki_hfish.ac, aes(Species, AB_exca)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p8d <- p8d + xlab("Site") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8d <- p8d + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p8d
p8 <- ggplot(ki_hfish.ac, aes(Site, AB_exca)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p8 <- p8 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8 <- p8 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p8
View(ki_17)
p8d <- ggplot(ki_17$Site, aes(Species, Number)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
View(ki_fish)
View(ki_fish)
View(ki_full)
ki_full.ac <- droplevels(ki_full.ac)
ki_full.ac <- ki_full[ki_full$Site%in%fsites.to.keep,]
ki_full.ac <- droplevels(ki_full.ac)
View(ki_full.ac)
site5 <- c(5)
ki.5 <- ki_full.ac[ki_full.ac$Site%in%site5,]
ki.5 <- droplevels(ki.5)
View(ki.5)
site8 <- c(8)
site32 <- c(32)
site35 <- c(35)
site40 <- c(40)
ki.5 <- ki_full.ac[ki_full.ac$Site%in%site5,]
ki.5 <- droplevels(ki.5)
ki.8 <- ki_full.ac[ki_full.ac$Site%in%site8,]
ki.8 <- droplevels(ki.8)
ki.32 <- ki_full.ac[ki_full.ac$Site%in%site32,]
ki.32 <- droplevels(ki.32)
ki.35 <- ki_full.ac[ki_full.ac$Site%in%site35,]
ki.35 <- droplevels(ki.35)
ki.40 <- ki_full.ac[ki_full.ac$Site%in%site40,]
ki.40 <- droplevels(ki.40)
View(ki.35)
ki.5ab <- ki.5 %>% group_by(Year, KI.Date, Site, Observer, f.pressure) %>% summarise(Abundance = sum(Number))
View(ki.5ab)
ki.5ab <- ki.5 %>% group_by(Year, Site, Observer, Species) %>% summarise(Abundance = sum(Number))
View(ki.5ab)
ki.5ab <- ki.5 %>% group_by(Year, Site, Species) %>% summarise(Abundance = sum(Number))
View(ki.5ab)
ki.8abo <- ki.8 %>% group_by(Year, Site, Observer, Species) %>% summarise(Abundance = sum(Number))
ki.8ab <- ki.8 %>% group_by(Year, Site, Species) %>% summarise(Abundance = sum(Number))
ki.32abo <- ki.32 %>% group_by(Year, Site, Observer, Species) %>% summarise(Abundance = sum(Number))
ki.32ab <- ki.32 %>% group_by(Year, Site, Species) %>% summarise(Abundance = sum(Number))
ki.35abo <- ki.35 %>% group_by(Year, Site, Observer, Species) %>% summarise(Abundance = sum(Number))
ki.35ab <- ki.35 %>% group_by(Year, Site, Species) %>% summarise(Abundance = sum(Number))
ki.40abo <- ki.40 %>% group_by(Year, Site, Observer, Species) %>% summarise(Abundance = sum(Number))
ki.40ab <- ki.40 %>% group_by(Year, Site, Species) %>% summarise(Abundance = sum(Number))
View(ki.32)
ki.5abo <- ki.5 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.5ab <- ki.5 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.8abo <- ki.8 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.8ab <- ki.8 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.32abo <- ki.32 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.32ab <- ki.32 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.35abo <- ki.35 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.35ab <- ki.35 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.40abo <- ki.40 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.40ab <- ki.40 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
View(ki.35abo)
p1 <- ggplot(fish.ac, aes(Site, AB_total)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1 <- p1 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1 <- p1 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p1
p1b <- ggplot(fish.ac, aes(Year, AB_total)) + geom_boxplot(aes(fill = Year))
p1b <- p1b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1b <- p1b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
#p1b <- p1b + ylim(0,3000)
p1b
p1c <- ggplot(fish.ac, aes(f.pressure, AB_total)) + geom_boxplot(aes(fill = f.pressure))
p1c <- p1c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1c <- p1c +guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
#p1c <- p1c + ylim(0,3000)
p1c
p1d <- ggplot(ki.32ab, aes(Year, Abundance)) + geom_bar(aes( stat = "identity", position = "dodge"))
p1d <- ggplot(ki.32ab, aes(Year, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1d
p1d <- ggplot(ki.32ab, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1d
p1d <- p1d + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p1d
p1d <- p1d + theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 9))
p1d
p1d <- p1d + theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 4))
p1d
p1d <- p1d + theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 6))
p1d
p1d <- p1d + labs(title = "Total Species Abundance")
p1d
p8 <- ggplot(ki_hfish.ac, aes(Site, AB_exca)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p8 <- p8 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8 <- p8 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p8
p8b <- ggplot(ki_hfish.ac, aes(Year, AB_exca)) + geom_boxplot(aes(fill = Year))
p8b <- p8b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8b <- p8b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p8b
p8c <- ggplot(ki_hfish.ac, aes(f.pressure, AB_exca)) + geom_boxplot(aes(fill = f.pressure))
p8c <- p8c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Excavator Abundance")
p8c <- p8c + guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
p8c
View(ki.5abo)
ki.32ex <- ki.32ab[ki.32ab$FineFG%in%Excavators,]
Excavators <- c("Excavator", "Scraper")
ki.32ex <- ki.32ab[ki.32ab$FineFG%in%Excavators,]
View(ki.32ex)
ki.35ex <- ki.35ab[ki.35ab$FineFG%in%Excavators,]
ki.40ex <- ki.40ab[ki.40ab$FineFG%in%Excavators,]
p8d <- ggplot(ki.32ex, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p8d <- p8d + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p8d <- p8d + labs(title = "Site 32 Excavator Abundance")
p8d
p8d <- ggplot(ki.32ex, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "fill")
p8d <- p8d + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p8d <- p8d + labs(title = "Site 32 Excavator Abundance")
p8d
p8d <- ggplot(ki.32ex, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "stack")
p8d <- p8d + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p8d <- p8d + labs(title = "Site 32 Excavator Abundance")
p8d
p8d <- ggplot(ki.32ex, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p8d <- p8d + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p8d <- p8d + labs(title = "Site 32 Excavator Abundance")
p8d
p8e <- ggplot(ki.35ex, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p8e <- p8e + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p8e <- p8e + labs(title = "Site 35 Excavator Abundance")
p8e
p8f <- ggplot(ki.40ex, aes(Species, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p8f <- p8f + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p8f <- p8f + labs(title = "Site 40 Excavator Abundance")
p8f
p7 <- ggplot(fish.ac, aes(Site, AB_herb)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p7 <- p7 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Herbivore Abundance")
p7 <- p7 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p7
p9 <- ggplot(ki_hfish.ac, aes(Site, AB_graz)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p9 <- p9 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Grazer Abundance")
p9 <- p9 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p9
p9b <- ggplot(ki_hfish.ac, aes(Year, AB_graz)) + geom_boxplot(aes(fill = Year))
p9b <- p9b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Grazer Abundance")
p9b <- p9b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p9b
p9c <- ggplot(ki_hfish.ac, aes(f.pressure, AB_exca)) + geom_boxplot(aes(fill = f.pressure))
p9c <- p9c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Grazer Abundance")
p9c <- p9c + guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
p9c
View(ki_full.ac)
ki.32ab <- ki.32 %>% group_by(Year, Site, Species, Family, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
library(dplyr)
library(ggplot2)
library(RColorBrewer)
## Load data (CHANGE TO MY DATA EXPORTED BY THE CLEANING)
#load("../Data/KI_UVC_13_15_17_trans.Rdata")
#load("../Data/KI_UVC_13_15_17.Rdata")
#load("../Data/KI_UVC_13_15_17_BM_trans.Rdata")
load("C:/Users/Sdimo/Documents/GitHub/ki-fish/Sean_Acoustics/KI_UVC_17_18.Rdata")
load("C:/Users/Sdimo/Documents/GitHub/ki-fish/Sean_Acoustics/KI_UVC_17_18_obs_sum.Rdata")
load("C:/Users/Sdimo/Documents/GitHub/ki-fish/Sean_Acoustics/KI_UVC_17_18_obs_herb_sum.Rdata")
library(here)
## Load necessary packages
library(dplyr)
library(ggplot2)
library(RColorBrewer)
## Set theme for plots
theme_set(theme_bw() + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.x = element_text(size = 14, color = "black"),
axis.text.y = element_text(size = 14, color = "black"),
axis.ticks = element_blank(),
axis.title.y = element_text(size = 17, margin = margin(0,20,0,0)),
axis.title.x = element_text(size = 17, margin = margin(20,0,0,0)),
plot.title = element_text(size = 20, margin = margin(0,0,15,0)),
plot.margin = margin(10,10,10,20),
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", size = 12),
panel.border = element_rect(color = "black", fill = NA, size = 1),
panel.grid.major = element_blank(), panel.grid.minor = element_blank()))
## Find which sites are present at each time point
#sites_13 <- unique(ki_fish$Site[ki_fish$Year == "2013"])
#sites_15 <- unique(ki_fish$Site[ki_fish$Year == "2015"])
#sites_17 <- unique(ki_fish$Site[ki_fish$Year == "2017"])
# Sites surveyed before/during the El Nino
#sites_BD <- intersect(sites_13, sites_15)
# Sites surveyed before/after the El Nino
#sites_BA <- intersect(sites_13, sites_17)
# Sites surveyed in all three time points
#sites_BDA <- Reduce(intersect, list(sites_13, sites_15, sites_17))
#Filter for only my 5 hydrophone sites
fsites.to.keep <- c(5,35,8,40,32)
fish.ac <- ki_fish[ki_fish$Site%in%fsites.to.keep,]
fish.ac <- droplevels(fish.ac)
ki_hfish.ac <- ki_hfish[ki_hfish$Site%in%fsites.to.keep,]
ki_hfish.ac <- droplevels(ki_hfish.ac)
ki_full.ac <- ki_full[ki_full$Site%in%fsites.to.keep,]
ki_full.ac <- droplevels(ki_full.ac)
#create one dataframe for each of my 5 sites
site5 <- c(5)
site8 <- c(8)
site32 <- c(32)
site35 <- c(35)
site40 <- c(40)
ki.5 <- ki_full.ac[ki_full.ac$Site%in%site5,]
ki.5 <- droplevels(ki.5)
ki.8 <- ki_full.ac[ki_full.ac$Site%in%site8,]
ki.8 <- droplevels(ki.8)
ki.32 <- ki_full.ac[ki_full.ac$Site%in%site32,]
ki.32 <- droplevels(ki.32)
ki.35 <- ki_full.ac[ki_full.ac$Site%in%site35,]
ki.35 <- droplevels(ki.35)
ki.40 <- ki_full.ac[ki_full.ac$Site%in%site40,]
ki.40 <- droplevels(ki.40)
#Grouping and summarizing each site by species abundance
ki.5abo <- ki.5 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.5ab <- ki.5 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.8abo <- ki.8 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.8ab <- ki.8 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.32abo <- ki.32 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.32ab <- ki.32 %>% group_by(Year, Site, Species, Family, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.35abo <- ki.35 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.35ab <- ki.35 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.40abo <- ki.40 %>% group_by(Year, Site, Observer, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
ki.40ab <- ki.40 %>% group_by(Year, Site, Species, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
#pulling excavators for some sites
Excavators <- c("Excavator", "Scraper")
ki.32ex <- ki.32ab[ki.32ab$FineFG%in%Excavators,]
ki.35ex <- ki.35ab[ki.35ab$FineFG%in%Excavators,]
ki.40ex <- ki.40ab[ki.40ab$FineFG%in%Excavators,]
## Filter for sites present in all years
#ki_fish <- filter(ki_fish, Site %in% sites_BDA)
#ki_fish_BM <- filter(ki_fish_BM, Site %in% sites_BDA)
## Order human disturbance levels
levels(fish.ac$f.pressure)
fish.ac$f.pressure <- factor(fish.ac$f.pressure, levels(factor(fish.ac$f.pressure))[c(5,2,3,1,4)])
#levels(ki_fish_BM$f.pressure)
#ki_fish_BM$f.pressure <- factor(ki_fish_BM$f.pressure, #levels(factor(ki_fish_BM$f.pressure))[c(5,2,3,1,4)])
## Order sites for plotting (WILL NEED TO CHANGE TO MY 5 SITES)
levels(fish.ac$Site)
fish.ac$Site <- factor(fish.ac$Site, levels(factor(fish.ac$Site))[c(1,2,4,3,5)])
#levels(ki_fish_BM$Site)
#ki_fish_BM$Site <- factor(ki_fish_BM$Site, #levels(factor(ki_fish_BM$Site))[c(4,5,7,10,1,11,3,6,13,12,2,8,9)])
#ki_fish_BM$Site <- factor(ki_fish_BM$Site, levels(factor(ki_fish_BM$Site))[c(8,3,11,1,2,10,9,5,7,12,13,4,6)])
p1 <- ggplot(fish.ac, aes(Site, AB_total)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1 <- p1 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1 <- p1 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p1
p1b <- ggplot(fish.ac, aes(Year, AB_total)) + geom_boxplot(aes(fill = Year))
p1b <- p1b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1b <- p1b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
#p1b <- p1b + ylim(0,3000)
p1b
p1c <- ggplot(fish.ac, aes(f.pressure, AB_total)) + geom_boxplot(aes(fill = f.pressure))
p1c <- p1c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1c <- p1c +guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
#p1c <- p1c + ylim(0,3000)
p1c
p1d <- ggplot(ki.32ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1d <- p1d + theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 6))
p1d <- p1d + labs(title = "Total Species Abundance at Site 32")
p1d
ki.40ab <- ki.40 %>% group_by(Year, Site, Species, Family, CoarseFG, FineFG) %>% summarise(Abundance = sum(Number))
p1 <- ggplot(fish.ac, aes(Site, AB_total)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1 <- p1 + xlab("Site") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1 <- p1 + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
p1
p1b <- ggplot(fish.ac, aes(Year, AB_total)) + geom_boxplot(aes(fill = Year))
p1b <- p1b + xlab("Year") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1b <- p1b + guides(fill = FALSE) + scale_fill_manual(values = c("#3399CC", "#99CCFF", "#006699"))
#p1b <- p1b + ylim(0,3000)
p1b
p1c <- ggplot(fish.ac, aes(f.pressure, AB_total)) + geom_boxplot(aes(fill = f.pressure))
p1c <- p1c + xlab("Human Disturbance") + ylab("Mean Abundance") + labs(title = "Total Fish Abundance")
p1c <- p1c +guides(fill = FALSE) + scale_fill_manual(values = c("#01665E", "#80CDC1", "#DFC27D", "#BF812D", "#663300"))
#p1c <- p1c + ylim(0,3000)
p1c
p1d <- ggplot(ki.32ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1d <- p1d + theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 6))
p1d <- p1d + labs(title = "Total Species Abundance at Site 32")
p1d
p1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1e <- p1e + theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 6))
p1e <- p1e + labs(title = "Total Species Abundance at Site 40")
p1e
p1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1e <- p1e + theme(axis.text.x = element_text(angle = 90, size = 8))
p1e <- p1e + labs(title = "Total Species Abundance at Site 40")
p1e
p1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1e <- p1e + theme(axis.text.x = element_text(angle = 90, size = 6))
p1e <- p1e + labs(title = "Total Species Abundance at Site 40")
p1e
p1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1e <- p1e + theme(axis.text.x = element_text(angle = 90, hjust = -.05, size = 8))
p1e <- p1e + labs(title = "Total Species Abundance at Site 40")
p1e
p1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1e <- p1e + theme(axis.text.x = element_text(angle = 90, hjust = -1, size = 8))
p1e <- p1e + labs(title = "Total Species Abundance at Site 40")
p1e
p1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1e <- p1e + theme(axis.text.x = element_text(angle = 90, hjust = -.5, size = 8))
p1e <- p1e + labs(title = "Total Species Abundance at Site 40")
p1e
p1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1e <- p1e + theme(axis.text.x = element_text(angle = 90, size = 8))
p1e <- p1e + labs(title = "Total Species Abundance at Site 40")
p1e
p1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1e <- p1e + theme(axis.text.x = element_text(angle = 90, hjust = 0, size = 8))
p1e <- p1e + labs(title = "Total Species Abundance at Site 40")
p1e
p1d <- ggplot(ki.32ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1d <- p1d + theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 6))
p1d <- p1d + labs(title = "Total Species Abundance at Site 32")
p1d
p1d <- ggplot(ki.32ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1d <- p1d + theme(axis.text.x = element_text(angle = 90, hjust = 0, size = 6))
p1d <- p1d + labs(title = "Total Species Abundance at Site 32")
p1d
p1e <- ggplot(ki.40ab, aes(Family, Abundance)) + geom_bar(aes(fill = Year), stat = "identity", position = "dodge")
p1e <- p1e + theme(axis.text.x = element_text(angle = 90, hjust = -0.5, size = 8))
p1e <- p1e + labs(title = "Total Species Abundance at Site 40")
p1e
