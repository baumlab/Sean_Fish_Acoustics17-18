---
title: "Acoustic_2019_Explore3"
author: "Sean Dimoff"
date: "October 9, 2019"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
---

```{r setup, include=FALSE}
library(ggplot2)
library(cowplot)
library(rmarkdown)
library(knitr)
library(RColorBrewer)
library(GGally)
library(mctest)
library(usdm)
library(hms)
library(dplyr)
library(lme4)
library(MASS)
library(lmerTest)
library(goft)

##loading in the ACI/SPL data - wide form

#hourdata
#load("../Raw_Data/ACI_BB17hr.Rdata")
#load("../Raw_Data/ACI_BB18hr.Rdata")
#load("../Raw_Data/ACI_HF17hr.Rdata")
#load("../Raw_Data/ACI_HF18hr.Rdata")
#load("../Raw_Data/ACI_MF17hr.Rdata")
#load("../Raw_Data/ACI_MF18hr.Rdata")
#
#load("../Raw_Data/SPL_BB17hr.Rdata")
#load("../Raw_Data/SPL_BB18hr.Rdata")
#load("../Raw_Data/SPL_HF17hr.Rdata")
#load("../Raw_Data/SPL_HF18hr.Rdata")
#load("../Raw_Data/SPL_MF17hr.Rdata")
#load("../Raw_Data/SPL_MF18hr.Rdata")

#All time data
#load("../Raw_Data/SPL_BB17.Rdata")
#load("../Raw_Data/SPL_BB18.Rdata")

#load("../Raw_Data/SPLBB17long.Rdata")
#load("../Raw_Data/SPLBB18long.Rdata")

load("../Raw_Data/SPLHF17long.Rdata")
load("../Raw_Data/SPLHF18long.Rdata")


load("../Raw_Data/SPLMF17long.Rdata")
load("../Raw_Data/SPLMF18long.Rdata")


load("../Raw_Data/SPLHFlong.Rdata")
load("../Raw_Data/SPLMFlong.Rdata")

load("../Raw_Data/SPLMF.long.wind.Rdata")

#combined SPL and HF dataframes
load("../Raw_Data/Snap.HF17.Rdata")
load("../Raw_Data/Snap.HF18.Rdata")
#changing site to a character
Snap.HF17$Site.x <- as.character(Snap.HF17$Site.x)
Snap.HF18$Site.x <- as.character(Snap.HF18$Site.x)

load("../Raw_Data/Snap.HF.Rdata")



#daydata
#load("../Raw_Data/ACI_BB17day.Rdata")
#load("../Raw_Data/ACI_BB18day.Rdata")
#load("../Raw_Data/ACI_HF17day.Rdata")
#load("../Raw_Data/ACI_HF18day.Rdata")
#load("../Raw_Data/ACI_MF17day.Rdata")
#load("../Raw_Data/ACI_MF18day.Rdata")
#
#load("../Raw_Data/SPL_BB17day.Rdata")
#load("../Raw_Data/SPL_BB18day.Rdata")
#load("../Raw_Data/SPL_HF17day.Rdata")
#load("../Raw_Data/SPL_HF18day.Rdata")
#load("../Raw_Data/SPL_MF17day.Rdata")
#load("../Raw_Data/SPL_MF18day.Rdata")

#loading ACI/SPL long data for boxplots
#ACI
#load("../Raw_Data/ACI_BB17hrlong.Rdata")
#load("../Raw_Data/ACI_HF17hrlong.Rdata")
#load("../Raw_Data/ACI_MF17hrlong.Rdata")
#load("../Raw_Data/ACI_BB18hrlong.Rdata")
#load("../Raw_Data/ACI_HF18hrlong.Rdata")
#load("../Raw_Data/ACI_MF18hrlong.Rdata")
#
#load("../Raw_Data/ACI_MFhrlong.Rdata")
#load("../Raw_Data/ACI_HFhrlong.Rdata")
#load("../Raw_Data/ACI_BBhrlong.Rdata")
#
#load("../Raw_Data/ACI_BBhr_av.Rdata")
#load("../Raw_Data/ACI_HFhr_av.Rdata")
#load("../Raw_Data/ACI_MFhr_av.Rdata")
#
####making year a character
#ACI_BB.hr.long$Year <- as.character(ACI_BB.hr.long$Year)
#ACI_HF.hr.long$Year <- as.character(ACI_HF.hr.long$Year)
#ACI_MF.hr.long$Year <- as.character(ACI_MF.hr.long$Year)
#
###SPL
#load("../Raw_Data/SPL_BB17hrlong.Rdata")
#load("../Raw_Data/SPL_HF17hrlong.Rdata")
#load("../Raw_Data/SPL_MF17hrlong.Rdata")
#load("../Raw_Data/SPL_BB18hrlong.Rdata")
#load("../Raw_Data/SPL_HF18hrlong.Rdata")
#load("../Raw_Data/SPL_MF18hrlong.Rdata")
#
#load("../Raw_Data/SPL_MFhrlong.Rdata")
#load("../Raw_Data/SPL_HFhrlong.Rdata")
#load("../Raw_Data/SPL_BBhrlong.Rdata")
#
#load("../Raw_Data/SPL_BBhr_av.Rdata")
#load("../Raw_Data/SPL_HFhr_av.Rdata")
#load("../Raw_Data/SPL_MFhr_av.Rdata")
#
###making year a character
#SPL_BB.hr.long$Year <- as.character(SPL_BB.hr.long$Year)
#SPL_HF.hr.long$Year <- as.character(SPL_HF.hr.long$Year)
#SPL_MF.hr.long$Year <- as.character(SPL_MF.hr.long$Year)
#
##loading in fish call count data
#load("../Raw_Data/FC.05hr.Rdata")
#load("../Raw_Data/FC.08hr.Rdata")
#load("../Raw_Data/FC.32hr.Rdata")
#load("../Raw_Data/FC.35hr.Rdata")
#load("../Raw_Data/FC.40hr.Rdata")
#
#load("../Raw_Data/FC.CallperDayALL.Rdata")
#load("../Raw_Data/FC.CallperDay17.Rdata")
#load("../Raw_Data/FC.CallperDay18.Rdata")
#
#load("../Raw_Data/FC.CallperHourALL.Rdata")
#load("../Raw_Data/FC.CallperHour17.Rdata")
#load("../Raw_Data/FC.CallperHour18.Rdata")

#loading in total dataframe
#load("../Raw_Data/AC.DF.Rdata")




##loading in Boat visitation data
#load("../Raw_Data/BV.all.Rdata")
#load("../Raw_Data/BV.sum.Rdata")





##loading in lunar phase data
#load("../Raw_Data/LunarPhase2017.Rdata")
#load("../Raw_Data/LunarPhase2018.Rdata")


##loading in fish data
#load("../Raw_Data/ki_fishabundance.Rdata")
#load("../Raw_Data/ki_fishabundance17.Rdata")
#load("../Raw_Data/ki_fishabundance18.Rdata")
#
#load("../Raw_Data/ki_fishaverage.Rdata")
#load("../Raw_Data/ki_fishaverage17.Rdata")
#load("../Raw_Data/ki_fishaverage18.Rdata")


##loading in the full dataframe with all data
#load("../Raw_Data/AC.DF.Rdata")
load("../Raw_Data/AC.DF1.Rdata")

#making site a character
AC.DF1$Site <- as.character(AC.DF1$Site)

#writing scale funciton
center_scale <- function(x) {
  scale(x, scale = FALSE)
}

#making duplicate dataframes
AC.DF1C <- AC.DF1

Snap.HF17C <- Snap.HF17
Snap.HF18C <- Snap.HF18

#Creating centered AC.DF1 dataframe
AC.DF1C$SPL_HF <- center_scale(AC.DF1C$SPL_HF)
AC.DF1C$SPL_Midrange <- center_scale(AC.DF1C$SPL_Midrange)
AC.DF1C$Snaps <- center_scale(AC.DF1C$Snaps)
AC.DF1C$Tot_Knocks <- center_scale(AC.DF1C$Tot_Knocks)
AC.DF1C$Num_Herbivory <- center_scale(AC.DF1C$Num_Herbivory)
AC.DF1C$Num_L_calls <- center_scale(AC.DF1C$Num_L_calls)

#creating centered Snap.HF17 and 18 dataframes
Snap.HF17C$SPL_HF <- center_scale(Snap.HF17C$SPL_HF)
Snap.HF17C$Snaps <- center_scale(Snap.HF17C$Snaps)
Snap.HF18C$SPL_HF <- center_scale(Snap.HF18C$SPL_HF)
Snap.HF18C$Snaps <- center_scale(Snap.HF18C$Snaps)

#splitting dataframe by site
s5 <- filter(AC.DF1, Site == "5")
s32 <- filter(AC.DF1, Site == "32")
s35 <- filter(AC.DF1, Site == "35")
s40 <- filter(AC.DF1, Site == "40")
s8 <- filter(AC.DF1, Site == "8")

#splitting dataframe by hour
h3 <- filter(AC.DF1, Hour == "3")
h9 <- filter(AC.DF1, Hour == "9")
h15 <- filter(AC.DF1, Hour == "15")
h21 <- filter(AC.DF1, Hour == "21")

```
**Exploratory Plots for 2017-2018 Acoustic/Fish Data**

**Purpose** To explore the Acoustic data gathered in 2017 and 2018 to expose important trends between sites, diurnal patterns, fish abundance, lunar phase, and coral reef acoustics.

#Validations

**Combined Model** All variables are matched to the files that were used for Fish call counts (3:00, 9:00, 15:00, 21:00)

##Confidence Intervals
```{r CI, echo = FALSE}

##Knocks

#taking average and calculating confidence intervals for sites
knock.av <- aggregate(Tot_Knocks ~ Site, AC.DF1, mean)
knock.se <- aggregate(Tot_Knocks ~ Site, AC.DF1, function(x) sd(x)/sqrt(length(x)))
knock.av$SE <- knock.se$Tot_Knocks
knock.av$U.SE <- knock.av$Tot_Knocks + knock.av$SE
knock.av$L.SE <- knock.av$Tot_Knocks - knock.av$SE


#making site a character
knock.av$Site <- as.character(knock.av$Site)

knock.CI <- ggplot(knock.av, aes(Site, Tot_Knocks)) + 
  geom_errorbar(aes(ymin = L.SE, ymax = U.SE), color = "black", width = 0) +
  geom_point(aes(fill = Site), color = "black", pch = 21, size = 6) +
  labs(x = "Site", y = "Tot_Knocks", title = "Total Knocks")
knock.CI

#calculating confidence intervals for Hours
knock.hav <- aggregate(Tot_Knocks ~ Hour, AC.DF1, mean)
knock.hse <- aggregate(Tot_Knocks ~ Hour, AC.DF1, function(x) sd(x)/sqrt(length(x)))
knock.hav$SE <- knock.hse$Tot_Knocks
knock.hav$U.SE <- knock.hav$Tot_Knocks + knock.hav$SE
knock.hav$L.SE <- knock.hav$Tot_Knocks - knock.hav$SE

#making site a character
knock.hav$Hour <- as.character(knock.hav$Hour)

hknock.CI <- ggplot(knock.hav, aes(Hour, Tot_Knocks)) + 
  geom_errorbar(aes(ymin = L.SE, ymax = U.SE), color = "black", width = 0) +
  geom_point(aes(fill = Hour), color = "black", pch = 21, size = 6) +
  labs(x = "Hour", y = "Tot_Knocks", title = "Total Knocks")
hknock.CI

##Snaps

#snaps by site
snap.av <- aggregate(Snaps ~ Site, AC.DF1, mean)
snap.se <- aggregate(Snaps ~ Site, AC.DF1, function(x) sd(x)/sqrt(length(x)))
snap.av$SE <- snap.se$Snaps
snap.av$U.SE <- snap.av$Snaps + snap.av$SE
snap.av$L.SE <- snap.av$Snaps - snap.av$SE

#making site a character
snap.av$Site <- as.character(snap.av$Site)

snap.CI <- ggplot(snap.av, aes(Site, Snaps)) + 
  geom_errorbar(aes(ymin = L.SE, ymax = U.SE), color = "black", width = 0) +
  geom_point(aes(fill = Site), color = "black", pch = 21, size = 6) +
  labs(x = "Site", y = "Snaps", title = "Snaps per site")
snap.CI


##Long Calls

#LC by site
LC.av <- aggregate(Num_L_calls ~ Site, AC.DF1, mean)
LC.se <- aggregate(Num_L_calls ~ Site, AC.DF1, function(x) sd(x)/sqrt(length(x)))
LC.av$SE <- LC.se$Num_L_calls
LC.av$U.SE <- LC.av$Num_L_calls + LC.av$SE
LC.av$L.SE <- LC.av$Num_L_calls - LC.av$SE

#making site a character
LC.av$Site <- as.character(LC.av$Site)

LC.CI <- ggplot(LC.av, aes(Site, Num_L_calls)) + 
  geom_errorbar(aes(ymin = L.SE, ymax = U.SE), color = "black", width = 0) +
  geom_point(aes(fill = Site), color = "black", pch = 21, size = 6) +
  labs(x = "Site", y = "Long Calls", title = "Long Calls per site")
LC.CI

##Herbivory

#LC by site
H.av <- aggregate(Num_Herbivory ~ Site, AC.DF1, mean)
H.se <- aggregate(Num_Herbivory ~ Site, AC.DF1, function(x) sd(x)/sqrt(length(x)))
H.av$SE <- H.se$Num_Herbivory
H.av$U.SE <- H.av$Num_Herbivory + H.av$SE
H.av$L.SE <- H.av$Num_Herbivory - H.av$SE

#making site a character
H.av$Site <- as.character(H.av$Site)

H.CI <- ggplot(H.av, aes(Site, Num_Herbivory)) + 
  geom_errorbar(aes(ymin = L.SE, ymax = U.SE), color = "black", width = 0) +
  geom_point(aes(fill = Site), color = "black", pch = 21, size = 6) +
  labs(x = "Site", y = "Herbivory", title = "Herbivory per site")
H.CI




```

##Distributions

```{r histogram, echo = FALSE}
#plotting count histogram

Count.hist <- ggplot(data = AC.DF1, aes(AC.DF1$Tot_Knocks)) + geom_histogram()
Herb.hist <- ggplot(data = AC.DF1, aes(AC.DF1$Num_Herbivory)) + geom_histogram()
LC.hist <- ggplot(data = AC.DF1, aes(AC.DF1$Num_L_calls)) + geom_histogram()
Snap.hist <- ggplot(data = Snap.HF17, aes(Snap.HF17$Snaps)) + geom_histogram()

hist.p <- plot_grid(Count.hist, Herb.hist, LC.hist,Snap.hist, nrow = 2, ncol = 2)
hist.p

#plotting distributions of SPL response variables
MF.hist <- ggplot(data = AC.DF1, aes(AC.DF1$SPL_Midrange)) + geom_histogram() + ggtitle("MF SPL distribution")
#BB.hist <- ggplot(data = AC.DF1, aes(AC.DF1$SPL_BB)) + geom_histogram() + ggtitle("BB distribution")
HF.hist <- ggplot(data = AC.DF1, aes(AC.DF1$SPL_HF)) + geom_histogram() + ggtitle("HF SPL distribution")

hist1.p <- plot_grid(MF.hist, HF.hist, nrow = 1, ncol = 2)
hist1.p

#plotting distributions of ACI response variables
MF.hist1 <- ggplot(data = AC.DF1, aes(AC.DF1$ACI_Midrange)) + geom_histogram() + ggtitle("MF ACI distribution")
#BB.hist1 <- ggplot(data = AC.DF1, aes(AC.DF1$ACI_BB)) + geom_histogram()
HF.hist1 <- ggplot(data = AC.DF1, aes(AC.DF1$ACI_HF)) + geom_histogram() + ggtitle("HF ACI distribution")

hist2.p <- plot_grid(MF.hist1, HF.hist1, nrow = 1, ncol = 2)
hist2.p


```




##Regressions
Running basic regressions linking the explanatory to the response at their lowest levels and combined to see how different sites/ hours change the regression - SPL

**Linear Model outputs below each**

```{r regressions3, echo = FALSE}

SP.hf2 <- ggplot(Snap.HF17, aes(Snaps, SPL_HF)) + geom_point(aes(color=Site.x)) + ggtitle("Effect of snaps on HF SPL, 2017, split by site")

#pdf(file="../Figures/Snap_SPL_Regression2017.pdf", width = 11, height = 7)
SP.hf2 + geom_smooth(method = "lm") + ggtitle("Total Snaps and SPL HF, 2017")
#dev.off()

shf.lm17 = lm(SPL_HF ~ Snaps, data = Snap.HF17)
summary(shf.lm17)

#pdf(file="../Figures/Snap_SPL_Regression.pdf", width = 11, height = 7)
#SP.hf3 <- ggplot(Snap.HF, aes(Snaps, SPL_HF)) + geom_point() + geom_smooth(method = "lm")
#SP.hf3
#dev.off()

SP.hf2.1 <- ggplot(Snap.HF17, aes(Snaps, SPL_HF)) + geom_point(aes(color=Site.x)) + ggtitle("Effect of snaps on HF SPL, 2017, split by site") + facet_wrap(~Site.x)
SP.hf2.1 + geom_smooth(method = "lm") + ggtitle("Total Snaps and SPL HF, 2017")
```

2017 Snap data, snaps significant.

When you break it down by site, site 32 has the opposite relationship with high frequency and snaps.

###High Frequency

**2017 Snap/HF SPL Site Breakdown **

```{r regressions5snap, echo = FALSE}
#splitting dataframe by site
s17s5 <-  filter(Snap.HF17, Site.x == "5")
s17s32 <- filter(Snap.HF17, Site.x == "32")
s17s35 <- filter(Snap.HF17, Site.x == "35")
s17s40 <- filter(Snap.HF17, Site.x == "40")
s17s8 <-  filter(Snap.HF17, Site.x == "8")

SP.17hf5 <- ggplot(s17s5, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 5, 2017") + geom_smooth(method = "lm")
SP.17hf5
sp5lm17 = lm(SPL_HF ~Snaps, data = s17s5)
summary(sp5lm17)
```

```{r regression8snap, echo = FALSE}
SP.17hf8 <- ggplot(s17s8, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 8, 2017") + geom_smooth(method = "lm")
SP.17hf8
sp8lm17 = lm(SPL_HF ~Snaps, data = s17s8)
summary(sp8lm17)
```

```{r regression35snap, echo = FALSE}
SP.17hf35 <- ggplot(s17s35, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 35, 2017") + geom_smooth(method = "lm")
SP.17hf35
sp35lm17 = lm(SPL_HF ~Snaps, data = s17s35)
summary(sp35lm17)
```

```{r regression40snap, echo = FALSE}
SP.17hf40 <- ggplot(s17s40, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 40, 2017") + geom_smooth(method = "lm")
SP.17hf40
sp40lm17 = lm(SPL_HF ~Snaps, data = s17s40)
summary(sp40lm17)
```

```{r regression32snap, echo = FALSE}
SP.17hf32 <- ggplot(s17s32, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 32, 2017") + geom_smooth(method = "lm")
SP.17hf32
sp32lm17 = lm(SPL_HF ~Snaps, data = s17s32)
summary(sp32lm17)
```

**2018 Snap/HF SPL**
```{r regressions18, echo = FALSE}

SP.hf4 <- ggplot(Snap.HF18, aes(Snaps, SPL_HF)) + geom_point(aes(color=Site.x)) + ggtitle("Effect of snaps on SPL HF, 2018, split by site")
SP.hf4
```

Removing outliers

```{r regressions4, echo = FALSE}
#extreme outliers in 2018 - snap counts in the hundreds rather than thousands, going to find and remove them and run again
## Check that 2 divers were at all sites
low.snap <- Snap.HF18[Snap.HF18$Snaps <1000, ]
# Remove anything with fewer than 2 observers 

Snap.HF18E <- Snap.HF18[!(Snap.HF18$ds.id %in% low.snap$ds.id),]
#now rerunning without the 3 outliers

SP.hf4E <- ggplot(Snap.HF18E, aes(Snaps, SPL_HF)) + geom_point(aes(color=Site.x)) + ggtitle("Effect of snaps on SPL HF, 2018, split by site, outliers removed")

SP.hf4E + geom_smooth(method = "lm") + ggtitle("Total Snaps and SPL HF, 2018")
shf.lm18E = lm(SPL_HF ~ Snaps, data = Snap.HF18)
summary(shf.lm18E)

SP.hf4E.1 <- ggplot(Snap.HF18E, aes(Snaps, SPL_HF)) + geom_point(aes(color=Site.x)) + ggtitle("Effect of snaps on SPL HF, 2018, split by site, outliers removed") + facet_wrap(~Site.x)

SP.hf4E.1 + geom_smooth(method = "lm") + ggtitle("Total Snaps and SPL HF, 2018")
```

2018 Snap data with outliers removed. Snaps significant.

When split by sight, site 32 has a flat relationship.

**2018 Snap/HF SPL Site Breakdown **

```{r regressions5snap18, echo = FALSE}
#splitting dataframe by site
s18s5 <-  filter(Snap.HF18E, Site.x == "5")
s18s32 <- filter(Snap.HF18E, Site.x == "32")
s18s35 <- filter(Snap.HF18E, Site.x == "35")
s18s40 <- filter(Snap.HF18E, Site.x == "40")
s18s8 <-  filter(Snap.HF18E, Site.x == "8")

SP.18hf5 <- ggplot(s18s5, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 5, 2018") + geom_smooth(method = "lm")
SP.18hf5
sp5lm18 = lm(SPL_HF ~Snaps, data = s18s5)
summary(sp5lm18)
```

```{r regression8snap18, echo = FALSE}
SP.18hf8 <- ggplot(s18s8, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 8, 2018") + geom_smooth(method = "lm")
SP.18hf8
sp8lm18 = lm(SPL_HF ~Snaps, data = s18s8)
summary(sp8lm18)
```

```{r regression35snap18, echo = FALSE}
SP.18hf35 <- ggplot(s18s35, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 35, 2018") + geom_smooth(method = "lm")
SP.18hf35
sp35lm18 = lm(SPL_HF ~Snaps, data = s18s35)
summary(sp35lm18)
```

```{r regression40snap18, echo = FALSE}
SP.18hf40 <- ggplot(s18s40, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 40, 2018") + geom_smooth(method = "lm")
SP.18hf40
sp40lm18 = lm(SPL_HF ~Snaps, data = s18s40)
summary(sp40lm18)
```

```{r regression32snap18, echo = FALSE}
SP.18hf32 <- ggplot(s18s32, aes(Snaps, SPL_HF)) + geom_point() + ggtitle("Effect of snaps on HF SPL, Site 32, 2018") + geom_smooth(method = "lm")
SP.18hf32
sp32lm18 = lm(SPL_HF ~Snaps, data = s18s32)
summary(sp32lm18)
```

###Mid Frequency

**Mid Frequency **

```{r regressions, echo = FALSE}
#equation for r^2 value
#SP.mf1.3 <- ggplot(AC.DF1, aes(Tot_Knocks, SPL_Midrange)) + geom_point()
SP.mf1.1 <- ggplot(AC.DF1, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("Effect of knocks on SPL MF, split by site")
SP.mf1.2 <- ggplot(AC.DF1, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Hour)) + ggtitle("Effect of knocks on SPL MF, split by hour")

SP.mf1.1 + ggtitle("Total Knocks effect on SPL MF, split by site") + stat_smooth(method = "lm") 
SP.mf1.2 + ggtitle("Total Knocks effect on SPL MF, split by hour") + geom_smooth(method = "lm")
kmf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = AC.DF1)
summary(kmf.lm)

#pdf(file="../Figures/Knocks_MF_Regression.pdf", width = 11, height = 7)
#SP.mf1.3 + stat_smooth(method = "lm")
#dev.off()
```



2017-2018 data w/200 samples.  1st plot splits by site and second by hour to show any patterns before I break them down individually.


**Breakdown by Site**

```{r regressions5, echo = FALSE}
SPmf.5 <- ggplot(s5, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "royalblue4") + ggtitle("Site 5")

SPmf.5 + geom_smooth(method = "lm") + ggtitle("Site 5, MF SPL")
s5mf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = s5)
summary(s5mf.lm)
```

Site 5, knocks not significant.


```{r regressions6, echo = FALSE}
SPmf.35 <- ggplot(s35, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Orange") + ggtitle("Site 35")

SPmf.35 + geom_smooth(method = "lm") + ggtitle("Site 35, MF SPL")
s35mf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = s35)
summary(s35mf.lm)
```

Site 35, knocks significant.

Removing 2 outliers > 150

```{r regressions6E, echo = FALSE}

h.knock35 <- s35[s35$Tot_Knocks >150, ]
# Remove anything with fewer than 2 observers 

s35E <- s35[!(s35$st.id %in% h.knock35$st.id),]
#now rerunning without the 2 outliers

SPmf.35E <- ggplot(s35E, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Orange") + ggtitle("Site 35")

SPmf.35E + geom_smooth(method = "lm") + ggtitle("Site 35, MF SPL - outliers removed")
s35mf.lmE = lm(SPL_Midrange ~ Tot_Knocks, data = s35E)
summary(s35mf.lmE)

```

```{r regressions7, echo = FALSE}
SPmf.8 <- ggplot(s8, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Orange") + ggtitle("Site 8")

SPmf.8 + geom_smooth(method = "lm") + ggtitle("Site 8, MF SPL")
s8mf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = s8)
summary(s8mf.lm)
```

Site 8, knocks not significant. Negative relationship... thats interesting.

Removing Outlier

```{r regressions7E, echo = FALSE}

h.knock8 <- s8[s8$Tot_Knocks >200, ]
# Remove anything with fewer than 2 observers 

s8E <- s8[!(s8$st.id %in% h.knock8$st.id),]
#now rerunning without the 2 outliers

SPmf.8E <- ggplot(s8E, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Orange") + ggtitle("Site 8")

SPmf.8E + geom_smooth(method = "lm") + ggtitle("Site 8, MF SPL - outlier removed")
s8mf.lmE = lm(SPL_Midrange ~ Tot_Knocks, data = s8E)
summary(s8mf.lmE)

```


```{r regressions8, echo = FALSE}
SPmf.40 <- ggplot(s40, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Red") + ggtitle("Site 40")

SPmf.40 + geom_smooth(method = "lm") + ggtitle("Site 40, MF SPL")
s40mf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = s40)
summary(s40mf.lm)
```

Site 40, knocks not significant.

```{r regressions9, echo = FALSE}
SPmf.32 <- ggplot(s32, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Red") + ggtitle("Site 32")

SPmf.32 + geom_smooth(method = "lm") + ggtitle("Site 32, MF SPL")
s32mf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = s32)
summary(s32mf.lm)
```

Site 32, knocks significant.

### Mid Frequency - Hourly Breakdown
**Breakdown by Hour**

```{r regressions10, echo = FALSE}
SPmf.h3 <- ggplot(h3, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 AM")

SPmf.h3 + geom_smooth(method = "lm") + ggtitle("3 AM, MF SPL")
h3mf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = h3)
summary(h3mf.lm)
```

3AM, knocks not significant.

Splitting by site to see if any site has a relationship

```{r regressions10.1 , echo = FALSE}
SPmf.h3.1 <- ggplot(h3, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 AM") + facet_wrap(~Site)
SPmf.h3.1
SPmf.h3.1 + geom_smooth(method = "lm") + ggtitle("3 AM, MF SPL")
```


```{r regressions11, echo = FALSE}
SPmf.h9 <- ggplot(h9, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 AM")

SPmf.h9 + geom_smooth(method = "lm") + ggtitle("9 AM, MF SPL")
h9mf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = h9)
summary(h9mf.lm)
```

9AM, knocks significant

Splitting by site

```{r regressions11.1, echo = FALSE}
SPmf.h9.1 <- ggplot(h9, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 AM") + facet_wrap(~Site)

SPmf.h9.1 + geom_smooth(method = "lm") + ggtitle("9 AM, MF SPL")

```


```{r regressions12, echo = FALSE}
SPmf.h15 <- ggplot(h15, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 PM")

SPmf.h15 + geom_smooth(method = "lm") + ggtitle("3 PM, MF SPL")
h15mf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = h15)
summary(h15mf.lm)
```

3PM, knocks not significant

Splitting by site

```{r regressions12.1, echo = FALSE}
SPmf.h15.1 <- ggplot(h15, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 PM") + facet_wrap(~Site)

SPmf.h15.1 + geom_smooth(method = "lm") + ggtitle("3 PM, MF SPL")

```


```{r regressions13, echo = FALSE}
SPmf.h21 <- ggplot(h21, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 PM")

SPmf.h21 + geom_smooth(method = "lm") + ggtitle("9 PM, MF SPL")
h21mf.lm = lm(SPL_Midrange ~ Tot_Knocks, data = h21)
summary(h21mf.lm)
```

9PM, knocks not significant.

Splitting by site.

```{r regressions13.1, echo = FALSE}
SPmf.h21.1 <- ggplot(h21, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 PM") + facet_wrap(~Site)

SPmf.h21.1 + geom_smooth(method = "lm") + ggtitle("9 PM, MF SPL")

```

###Mid Frequency Hourly Breakdown (Long Calls)

```{r regressions LC 3 AM, echo = FALSE}
SPlc.h3 <- ggplot(h3, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 AM")
SPlc.h3 + geom_smooth(method = "lm") + ggtitle("3 AM, MF SPL")

SPlc.h3.1 <- ggplot(h3, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 AM") + facet_wrap(~Site)
SPlc.h3.1 + geom_smooth(method = "lm") + ggtitle("3 AM, MF SPL")

```

3 AM, long calls don't seem to explain a great deal of the relationship at any site

```{r regressions LC 9 AM, echo = FALSE}
SPlc.h9 <- ggplot(h9, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 AM")
SPlc.h9 + geom_smooth(method = "lm") + ggtitle("9 AM, MF SPL")

SPlc.h9.1 <- ggplot(h9, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 AM") + facet_wrap(~Site)
SPlc.h9.1 + geom_smooth(method = "lm") + ggtitle("9 AM, MF SPL")

```

9 AM, long calls don't seem to explain the relationship at any site

```{r regressions LC 15 PM, echo = FALSE}
SPlc.h15 <- ggplot(h15, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 PM")
SPlc.h15 + geom_smooth(method = "lm") + ggtitle("3 PM, MF SPL")

SPlc.h15.1 <- ggplot(h15, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 PM") + facet_wrap(~Site)
SPlc.h15.1 + geom_smooth(method = "lm") + ggtitle("3 PM, MF SPL")

```

3 PM, long calls don't seem to explain the relationship

```{r regressions LC 21 PM, echo = FALSE}
SPlc.h21 <- ggplot(h21, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 PM")
SPlc.h21 + geom_smooth(method = "lm") + ggtitle("9 PM, MF SPL")

SPlc.h21.1 <- ggplot(h21, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 PM") + facet_wrap(~Site)
SPlc.h21.1 + geom_smooth(method = "lm") + ggtitle("9 PM, MF SPL")

```

9 PM, long calls don't seem to explain the relationship

###Mid Frequency Hourly Breakdown (Herbivory)

```{r regressions Herb 3 AM, echo = FALSE}
SPherb.h3 <- ggplot(h3, aes(Num_Herbivory, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 AM")
SPherb.h3 + geom_smooth(method = "lm") + ggtitle("3 AM, MF SPL")

SPherb.h3.1 <- ggplot(h3, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 AM") + facet_wrap(~Site)
SPherb.h3.1 + geom_smooth(method = "lm") + ggtitle("3 AM, MF SPL")

```

3 AM, Extremely low herbivory at all sites.  No relationship

```{r regressions Herb 9 AM, echo = FALSE}
SPherb.h9 <- ggplot(h9, aes(Num_Herbivory, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 AM")
SPherb.h9 + geom_smooth(method = "lm") + ggtitle("9 AM, MF SPL")

SPherb.h9.1 <- ggplot(h9, aes(Num_Herbivory, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 AM") + facet_wrap(~Site)
SPherb.h9.1 + geom_smooth(method = "lm") + ggtitle("9 AM, MF SPL")

```

Again, extremely low herbivory, no relationship.

```{r regressions Herb 15 PM, echo = FALSE}
SPherb.h15 <- ggplot(h15, aes(Num_Herbivory, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 PM")
SPherb.h15 + geom_smooth(method = "lm") + ggtitle("3 PM, MF SPL")

SPherb.h15.1 <- ggplot(h15, aes(Num_Herbivory, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("3 PM") + facet_wrap(~Site)
SPherb.h15.1 + geom_smooth(method = "lm") + ggtitle("3 PM, MF SPL")

```

Higher herbivory.  Seems like there is a relationship at site 40, 8, and 35.

```{r regressions Herb 21 PM, echo = FALSE}
SPherb.h21 <- ggplot(h21, aes(Num_Herbivory, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 PM")
SPherb.h21 + geom_smooth(method = "lm") + ggtitle("9 PM, MF SPL")

SPherb.h21.1 <- ggplot(h21, aes(Num_Herbivory, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("9 PM") + facet_wrap(~Site)
SPherb.h21.1 + geom_smooth(method = "lm") + ggtitle("9 PM, MF SPL")

```

Higher herbivory here as well, although there is no positive relationship at any site.

**Summary**
Knocks significantly explained SPLMF at sites 35 and 32 and at 9AM.

###Abiotic Regressions (Wind) -SPL
Running basic regressions linking the wind to SPL at both HF and MF to see if wind speed is significantly affecting the sound
```{r abiotic regressions, echo = FALSE}
#equation for r^2 value

WP.1 <- ggplot(Snap.HF, aes(Wind.Speed, SPL_HF)) + geom_point(aes(color = Site)) + ggtitle("Effect of Wind on HF SPL") + stat_smooth(method = "glm")
WP.1

#making site a character
SPLMF.long.wind$Site <- as.character(SPLMF.long.wind$Site)
WP.2 <- ggplot(SPLMF.long.wind, aes(Wind.Speed, SPL_MF)) + geom_point(aes(color = Site)) + ggtitle("Effect of wind on MF SPL") + stat_smooth(method = "glm")
WP.2


```
Wind doesn't seem to impact SPL HF or MF in any particular direction. Although the wind range seems really small.



##Centered Regressions
Running basic regressions linking the explanatory to the response at their lowest levels and combined to see how different sites/ hours change the regression - SPL

**Linear Model outputs below each**

```{r cregressions3, echo = FALSE}
#splitting dataframe by site
s5c <- filter(AC.DF1C, Site == "5")
s32c <- filter(AC.DF1C, Site == "32")
s35c <- filter(AC.DF1C, Site == "35")
s40c <- filter(AC.DF1C, Site == "40")
s8c <- filter(AC.DF1C, Site == "8")

#splitting dataframe by hour
h3c <- filter(AC.DF1C, Hour == "3")
h9c <- filter(AC.DF1C, Hour == "9")
h15c <- filter(AC.DF1C, Hour == "15")
h21c <- filter(AC.DF1C, Hour == "21")

SP.hf2 <- ggplot(Snap.HF17C, aes(Snaps, SPL_HF)) + geom_point(aes(color=Site.x)) + ggtitle("Effect of snaps on HF SPL, 2017, split by site")

SP.hf2 + geom_smooth(method = "lm") + ggtitle("Total Snaps and SPL HF, 2017")
shf.lm17c = lm(SPL_HF ~ Snaps, data = Snap.HF17C)
summary(shf.lm17c)
```

2017 Snap data, snaps significant.


###Mid Frequency

**Mid Frequency **

```{r Cregressions, echo = FALSE}
#equation for r^2 value
SP.mf1.1C <- ggplot(AC.DF1C, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Site)) + ggtitle("Effect of knocks on SPL MF, split by site")
SP.mf1.2C <- ggplot(AC.DF1C, aes(Tot_Knocks, SPL_Midrange)) + geom_point(aes(color = Hour)) + ggtitle("Effect of knocks on SPL MF, split by hour")

SP.mf1.1C + ggtitle("Total Knocks effect on SPL MF, split by site") + stat_smooth(method = "lm") 
SP.mf1.2C + ggtitle("Total Knocks effect on SPL MF, split by hour") + geom_smooth(method = "lm")
kmf.lmc = lm(SPL_Midrange ~ Tot_Knocks, data = AC.DF1C)
summary(kmf.lmc)

SP.lmf1.1C <- ggplot(AC.DF1C, aes(Num_L_calls, SPL_Midrange)) + geom_point(aes(color = Site))
SP.lmf1.1C + ggtitle("Long Calls effect on SPL MF, split by site") + stat_smooth(method = "lm") 


SP.hmf1.1C <- ggplot(AC.DF1C, aes(Num_Herbivory, SPL_Midrange)) + geom_point(aes(color = Site))
SP.hmf1.1C + ggtitle("Herbivory effect on SPL MF, split by site") + stat_smooth(method = "lm")

```

2017-2018 data w/200 samples.  1st plot splits by site and second by hour to show any patterns before I break them down individually.


```{r C collinearity, echo = TRUE}

#subsetting only lm variables
AC.DF1Co <- subset(AC.DF1C, select = c(SPL_Midrange, Tot_Knocks, Num_L_calls, Num_Herbivory, Site, Hour))

vif(AC.DF1Co)

#no colinnearity found between explanatory variables
#ggpairs(AC.DF1Co)

```

All values are near 1, values of 4 or 5 would be moderate. 1 = no collinearity.  I think this means that we have no collinearity between my explanatory variables


**Breakdown by Site**

```{r Cregressions5, echo = FALSE}
SPmf.5c <- ggplot(s5c, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "royalblue4") + ggtitle("Site 5")

SPmf.5c + geom_smooth(method = "lm") + ggtitle("Site 5, MF SPL")
s5mf.lmc = lm(SPL_Midrange ~ Tot_Knocks, data = s5c)
summary(s5mf.lmc)
```

Site 5, knocks not significant.


```{r Cregressions6, echo = FALSE}
SPmf.35c <- ggplot(s35c, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Orange") + ggtitle("Site 35")

SPmf.35c + geom_smooth(method = "lm") + ggtitle("Site 35, MF SPL")
s35mf.lmc = lm(SPL_Midrange ~ Tot_Knocks, data = s35c)
summary(s35mf.lmc)
```

Site 35, knocks significant.

```{r Cregressions7, echo = FALSE}
SPmf.8c <- ggplot(s8c, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Orange") + ggtitle("Site 8")

SPmf.8c + geom_smooth(method = "lm") + ggtitle("Site 8, MF SPL")
s8mf.lmc = lm(SPL_Midrange ~ Tot_Knocks, data = s8c)
summary(s8mf.lmc)
```

Site 8, knocks not significant. Negative relationship... thats interesting.

```{r Cregressions8, echo = FALSE}
SPmf.40c <- ggplot(s40c, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Red") + ggtitle("Site 40")

SPmf.40c + geom_smooth(method = "lm") + ggtitle("Site 40, MF SPL")
s40mf.lmc = lm(SPL_Midrange ~ Tot_Knocks, data = s40c)
summary(s40mf.lmc)
```

Site 40, knocks not significant.

```{r Cregressions9, echo = FALSE}
SPmf.32c <- ggplot(s32c, aes(Tot_Knocks, SPL_Midrange)) + geom_point(color = "Red") + ggtitle("Site 32")

SPmf.32c + geom_smooth(method = "lm") + ggtitle("Site 32, MF SPL")
s32mf.lmc = lm(SPL_Midrange ~ Tot_Knocks, data = s32c)
summary(s32mf.lmc)
```

Site 32, knocks significant.

#Time-Series Acoustics
**Acoustics Breakdown** All acoustic metrics (SPL and ACI) are broken down into 2 frequency bands: High Frequency (Frequencies between 1 kHz - 22 kHz) and Mid Frequency (Frequencies between 160 Hz and 1 kHz)

*Note* 2017 had a 10 minute duty cycle with 5 minutes recording while 2018 had a 15 minute duty cycle with 5 minutes recording, so the number of files averages differs between years

##High Frequency

### High Frequency - Total Deployment
Plots of high frequency patterns, notice diurnal patterns with highest SPL at night and lowest during the day (this is shown in the literature), also notice the clear splits by site.

**Total Deployment, 2017**

```{r hf spl no av, echo = FALSE}
#splitting dataframe by site - 2017
s5h17 <- filter(SPLHF17.long, Site == "5")
s32h17 <- filter(SPLHF17.long, Site == "32")
s35h17 <- filter(SPLHF17.long, Site == "35")
s40h17 <- filter(SPLHF17.long, Site == "40")
s8h17 <- filter(SPLHF17.long, Site == "8")


#splitting dataframe by site - 2018
s5h18 <- filter(SPLHF18.long, Site == "5")
s32h18 <- filter(SPLHF18.long, Site == "32")
s35h18 <- filter(SPLHF18.long, Site == "35")
s40h18 <- filter(SPLHF18.long, Site == "40")
s8h18 <- filter(SPLHF18.long, Site == "8")

#splitting dataframe by site - combined
s5h <- filter(Snap.HF, Site == "5")
s32h <- filter(Snap.HF, Site == "32")
s35h <- filter(Snap.HF, Site == "35")
s40h <- filter(Snap.HF, Site == "40")
s8h <- filter(Snap.HF, Site == "8")


#2017

#converting site to character
SPLHF17.long$Site <- as.character(SPLHF17.long$Site)

#comparing between sites for entire deployment
full.SPLHF17 <- ggplot(data =SPLHF17.long, aes(x=datetime, y = SPL_HF)) + 
  geom_point(aes(color = Site)) + geom_smooth(aes(color = Site), method = "loess") +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, 2017")

full.SPLHF17

```


**Site Breakdown Total Deployment 2017**

```{r hf site breakdown 2017, fig.width = 15, fig.height = 20, echo = FALSE}

hf17.5 <- ggplot(data =s5h17, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "royalblue4") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 5, 2017")

hf17.8 <- ggplot(data =s8h17, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 8, 2017")

hf17.35 <- ggplot(data =s35h17, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 35, 2017")

hf17.40 <- ggplot(data =s40h17, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 40, 2017")

hf17.32 <- ggplot(data =s32h17, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 32, 2017")

hf.SPL.breakdown17 <- plot_grid(hf17.5, hf17.8, hf17.35, hf17.40, hf17.32, nrow = 5, ncol = 1, align = "v")
hf.SPL.breakdown17

```

**Total Deployment, 2018**

```{r hf total deployment 2018, echo = FALSE}

#2018
#converting site to character
SPLHF18.long$Site <- as.character(SPLHF18.long$Site)

#comparing between sites for entire deployment
full.SPLHF18 <- ggplot(data =SPLHF18.long, aes(x=datetime, y = SPL_HF)) + 
  geom_point(aes(color = Site)) + geom_smooth(aes(color = Site), method = "loess") +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, 2018")

full.SPLHF18

```

**Site Breakdown Total Deployment 2018**

```{r hf site breakdown 2018, fig.width = 15, fig.height = 20, echo = FALSE}

hf18.5 <- ggplot(data =s5h18, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "royalblue4") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 5, 2018")

hf18.8 <- ggplot(data =s8h18, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 8, 2018")

hf18.35 <- ggplot(data =s35h18, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 35, 2018")

hf18.40 <- ggplot(data =s40h18, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 40, 2018")

hf18.32 <- ggplot(data =s32h18, aes(x=datetime, y = SPL_HF)) + 
  geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL total deployment, Site 32, 2018")

hf.SPL.breakdown18 <- plot_grid(hf18.5, hf18.8, hf18.35, hf18.40, hf18.32, nrow = 5, ncol = 1, align = "v")
hf.SPL.breakdown18

```

### High Frequency - Diurnal Patterns

**Diurnal Pattern, 2017**

```{r hf diurnal pattern 2017, echo = FALSE}

#converting date to character
SPLHF17.long$Date <- as.character(SPLHF17.long$Date)

#converting site to character
SPLHF17.long$Site <- as.character(SPLHF17.long$Site)

#comparing between sites for 1 day
day.SPLHF17 <- ggplot(data = SPLHF17.long, aes(x= Time, y = SPL_HF)) + geom_point(aes(color = Site)) + theme(axis.text.x = element_text(angle = 90)) + geom_smooth(aes(color = Site), method = "loess") + ggtitle("HF SPL diurnal patterns, 2017")

day.SPLHF17

```

**Diurnal Pattern Site Breakdown, 2017**

```{r hf diurnal pattern site breakdown 2017, fig.width = 15, fig.height = 20, echo = FALSE}

dhf17.5 <- ggplot(data = s5h17, aes(x= Time, y = SPL_HF)) + geom_point(color = "royalblue4") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 5, 2017")

dhf17.8 <- ggplot(data = s8h17, aes(x= Time, y = SPL_HF)) + geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 8, 2017")

dhf17.35 <- ggplot(data = s35h17, aes(x= Time, y = SPL_HF)) + geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 35, 2017")

dhf17.40 <- ggplot(data = s40h17, aes(x= Time, y = SPL_HF)) + geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 40, 2017")

dhf17.32 <- ggplot(data = s32h17, aes(x= Time, y = SPL_HF)) + geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 32, 2017")

dhf.SPL.breakdown17 <- plot_grid(dhf17.5, dhf17.8, dhf17.35, dhf17.40, dhf17.32, nrow = 5, ncol = 1, align = "v")
dhf.SPL.breakdown17

```

**Diurnal Pattern, 2018**

```{r hf diurnal pattern 2018, echo = FALSE}

#converting date to character
SPLHF18.long$Date <- as.character(SPLHF18.long$Date)

#converting site to character
SPLHF18.long$Site <- as.character(SPLHF18.long$Site)

#comparing between sites for 1 day
day.SPLHF18 <- ggplot(data = SPLHF18.long, aes(x= Time, y = SPL_HF)) + geom_point(aes(color = Site)) + theme(axis.text.x = element_text(angle = 90)) + geom_smooth(aes(color = Site), method = "loess") + ggtitle("HF SPL diurnal patterns, 2018")

day.SPLHF18

```

**Diurnal Pattern Site Breakdown, 2018**

```{r hf diurnal pattern site breakdown 201, fig.width = 15, fig.height = 20, echo = FALSE}

dhf18.5 <- ggplot(data = s5h18, aes(x= Time, y = SPL_HF)) + geom_point(color = "royalblue4") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 5, 2018")

dhf18.8 <- ggplot(data = s8h18, aes(x= Time, y = SPL_HF)) + geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 8, 2018")

dhf18.35 <- ggplot(data = s35h18, aes(x= Time, y = SPL_HF)) + geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 35, 2018")

dhf18.40 <- ggplot(data = s40h18, aes(x= Time, y = SPL_HF)) + geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 40, 2018")

dhf18.32 <- ggplot(data = s32h18, aes(x= Time, y = SPL_HF)) + geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("HF SPL diurnal patterns, Site 32, 2018")

dhf.SPL.breakdown18 <- plot_grid(dhf18.5, dhf18.8, dhf18.35, dhf18.40, dhf18.32, nrow = 5, ncol = 1, align = "v")
dhf.SPL.breakdown18

```


*Note* site 35 seems to have switched position between 2017 and 2018 but all of the other sites seem to be staying more or less in the same spot

- I wonder if this has to do with macroalgal cover changes between 2017 and 2018



###Snap-Breakdowns

Running this to see if snaps follow the same trends as SPL HF at all sites

```{r snapsovertime, echo = FALSE}


SP.t1 <- ggplot(Snap.HF, aes(Time, Snaps)) + geom_point(aes(color = Site))
SP.t1

#plotting by site
SP.t5 <- ggplot(s5h, aes(Time, Snaps)) + geom_point(color = "Green") + ggtitle("Site 5")

SP.t32 <- ggplot(s32h, aes(Time, Snaps)) + geom_point(color = "Red" ) + ggtitle("Site 32")

SP.t35 <- ggplot(s35h, aes(Time, Snaps)) + geom_point(color = "Orange") + ggtitle("Site 35")

SP.t40 <- ggplot(s40h, aes(Time, Snaps)) + geom_point(color = "Red") + ggtitle("Site 40")

SP.t8 <- ggplot(s8h, aes(Time, Snaps)) + geom_point(color = "Orange") + ggtitle("Site 8")

SP.t5
SP.t8
SP.t35
SP.t40
SP.t32

```



##Mid Frequency

### Mid Frequency - Total Deployment

Plots of mid frequency patterns, notice opposite diurnal patterns with highest SPL during the day and lowest at night, also notice the clear splits by site.

**2017 All Sites **

```{r mf spl no av, echo = FALSE}
#2017

#converting site to character
SPLMF17.long$Site <- as.character(SPLMF17.long$Site)

#splitting SPLMF17 down by site
mf17.5 <- filter(SPLMF17.long, Site == "5")
mf17.8 <- filter(SPLMF17.long, Site == "8")
mf17.32 <- filter(SPLMF17.long, Site == "32")
mf17.35 <- filter(SPLMF17.long, Site == "35")
mf17.40 <- filter(SPLMF17.long, Site == "40")

#splitting SPLMF18 down by site
mf18.5 <- filter(SPLMF18.long, Site == "5")
mf18.8 <- filter(SPLMF18.long, Site == "8")
mf18.32 <- filter(SPLMF18.long, Site == "32")
mf18.35 <- filter(SPLMF18.long, Site == "35")
mf18.40 <- filter(SPLMF18.long, Site == "40")

#comparing between sites for entire deployment
full.SPLMF17 <- ggplot(data =SPLMF17.long, aes(x=datetime, y = SPL_MF)) + 
  geom_point(aes(color = Site)) + geom_smooth(aes(color = Site), method = "loess") +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, 2017")

full.SPLMF17
```

**Site Breakdown, 2017**

```{r mf spl time by site 2017, fig.width = 15, fig.height = 20, echo = FALSE}
#plotting each site individually

pSPLMF17.5 <- ggplot(data = mf17.5, aes(x =datetime, y = SPL_MF)) + geom_point(color = "royalblue4") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 5, 2017")

pSPLMF17.8 <- ggplot(data = mf17.8, aes(x =datetime, y = SPL_MF)) + geom_point(color = "Orange") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 8, 2017")

pSPLMF17.32 <- ggplot(data = mf17.32, aes(x =datetime, y = SPL_MF)) + geom_point(color = "Red") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 32, 2017")

pSPLMF17.35 <- ggplot(data = mf17.35, aes(x =datetime, y = SPL_MF)) + geom_point(color = "Orange") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 35, 2017")

pSPLMF17.40 <- ggplot(data = mf17.40, aes(x =datetime, y = SPL_MF)) + geom_point(color = "Red") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 40, 2017")

pSPLMF17 <- plot_grid(pSPLMF17.5, pSPLMF17.8, pSPLMF17.35, pSPLMF17.40, pSPLMF17.32, nrow = 5, ncol = 1, align = "v")
pSPLMF17

```

**2018 All Sites**

```{r mf spl time 2018, echo = FALSE}

full.SPLMF18 <- ggplot(data =SPLMF18.long, aes(x=datetime, y = SPL_MF)) + 
  geom_point(aes(color = Site)) + geom_smooth(aes(color = Site), method = "loess") +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, 2018")

full.SPLMF18

```


**Site Breakdown, 2018**

```{r mf spl time by site 2018, fig.width = 15, fig.height = 20, echo = FALSE}
#plotting each site individually

pSPLMF18.5 <- ggplot(data = mf18.5, aes(x =datetime, y = SPL_MF)) + geom_point(color = "royalblue4") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 5, 2018")

pSPLMF18.8 <- ggplot(data = mf18.8, aes(x =datetime, y = SPL_MF)) + geom_point(color = "Orange") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 8, 2018")

pSPLMF18.32 <- ggplot(data = mf18.32, aes(x =datetime, y = SPL_MF)) + geom_point(color = "Red") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 32, 2018")

pSPLMF18.35 <- ggplot(data = mf18.35, aes(x =datetime, y = SPL_MF)) + geom_point(color = "Orange") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 35, 2018")

pSPLMF18.40 <- ggplot(data = mf18.40, aes(x =datetime, y = SPL_MF)) + geom_point(color = "Red") + theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF SPL total deployment, Site 40, 2018")

pSPLMF18 <- plot_grid(pSPLMF18.5, pSPLMF18.8, pSPLMF18.35, pSPLMF18.40, pSPLMF18.32, nrow = 5, ncol = 1, align = "v")
pSPLMF18

```

### Mid Frequency - Diurnal Patterns

**All Sites, 2017**

```{r mf spl diurnal cycle 2017, echo = FALSE}
#converting date to character
SPLMF17.long$Date <- as.character(SPLMF17.long$Date)

#converting date to character
mf17.5$Date <- as.character(mf17.5$Date)
mf17.8$Date <- as.character(mf17.8$Date)
mf17.32$Date <- as.character(mf17.32$Date)
mf17.35$Date <- as.character(mf17.35$Date)
mf17.40$Date <- as.character(mf17.40$Date)



#comparing between sites for 1 day
day.SPLMF17 <- ggplot(data = SPLMF17.long, aes(x= Time, y = SPL_MF)) + geom_point(aes(color = Site)) + theme(axis.text.x = element_text(angle = 90)) + geom_smooth(aes(color = Site), method = "loess") + ggtitle("MF SPL diurnal patterns, 2017")

day.SPLMF17
```

**Site Breakdown, 2017**

```{r mf spl diurnal cycle site breakdown 2017, fig.width = 15, fig.height = 20, echo = FALSE}
dSPLMF17.5 <- ggplot(data = mf17.5, aes(x= Time, y = SPL_MF)) + geom_point(color = "royalblue4") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 5, 2017")

dSPLMF17.8 <- ggplot(data = mf17.8, aes(x= Time, y = SPL_MF)) + geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 8, 2017")

dSPLMF17.35 <- ggplot(data = mf17.35, aes(x= Time, y = SPL_MF)) + geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 35, 2017")

dSPLMF17.40 <- ggplot(data = mf17.40, aes(x= Time, y = SPL_MF)) + geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 40, 2017")

dSPLMF17.32 <- ggplot(data = mf17.32, aes(x= Time, y = SPL_MF)) + geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 32, 2017")

dSPLMF17 <- plot_grid(dSPLMF17.5, dSPLMF17.8, dSPLMF17.35, dSPLMF17.40, dSPLMF17.32, nrow = 5, ncol = 1, align = "v")
dSPLMF17

```

**All Sites, 2018**

```{r mf spl diurnal cycle 2018, echo = FALSE}
#2018

#comparing between sites for 1 day
day.SPLMF18 <- ggplot(data = SPLMF18.long, aes(x= Time, y = SPL_MF)) + geom_point(aes(color = Site)) + theme(axis.text.x = element_text(angle = 90)) + geom_smooth(aes(color = Site), method = "loess") + ggtitle("MF SPL diurnal patterns, 2018")

day.SPLMF18

```

**Site Breakdown, 2018**

```{r mf spl diurnal cycle site breakdown 2018, fig.width = 15, fig.height = 20, echo = FALSE}
dSPLMF18.5 <- ggplot(data = mf18.5, aes(x= Time, y = SPL_MF)) + geom_point(color = "royalblue4") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 5, 2018")

dSPLMF18.8 <- ggplot(data = mf18.8, aes(x= Time, y = SPL_MF)) + geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 8, 2018")

dSPLMF18.35 <- ggplot(data = mf18.35, aes(x= Time, y = SPL_MF)) + geom_point(color = "orange") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 35, 2018")

dSPLMF18.40 <- ggplot(data = mf18.40, aes(x= Time, y = SPL_MF)) + geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 40, 2018")

dSPLMF18.32 <- ggplot(data = mf18.32, aes(x= Time, y = SPL_MF)) + geom_point(color = "red") + theme(axis.text.x = element_text(angle = 90))+ ggtitle("MF SPL diurnal patterns, Site 32, 2018")

dSPLMF18 <- plot_grid(dSPLMF18.5, dSPLMF18.8, dSPLMF18.35, dSPLMF18.40, dSPLMF18.32, nrow = 5, ncol = 1, align = "v")
dSPLMF18

```




##Combo Plots

### Combo Plots - Total Deployment

**Total Deployment All Sites, 2017**

```{r combo hf mf 2017, echo = FALSE}
#creating combined dataframe
SPL.both17 <- cbind(SPLMF17.long, SPLHF17.long$SPL_HF)

SPL.both18 <- cbind(SPLMF18.long, SPLHF18.long$SPL_HF)

#splitting this by site - 2017
cp17.5 <- filter(SPL.both17, Site == "5")
cp17.8 <- filter(SPL.both17, Site == "8")
cp17.32 <- filter(SPL.both17, Site == "32")
cp17.35 <- filter(SPL.both17, Site == "35")
cp17.40 <- filter(SPL.both17, Site == "40")


#renaming columns
names(SPL.both17) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")
names(SPL.both18) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")

names(cp17.5) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")
names(cp17.8) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")
names(cp17.32) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")
names(cp17.35) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")
names(cp17.40) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")

#comparing between sites for entire deployment
full.SPL17 <- ggplot(data =SPL.both17, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = Site)) + geom_point(aes(y = SPL_HF, color = Site)) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF and HF SPL total deployment, 2017")
full.SPL17

```

**Total Deployment Site Breakdown, 2017**

```{r combo site breakdown 2017, fig.width = 15, fig.height = 20, echo = FALSE}
cpSPL17.5 <- ggplot(data =cp17.5, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 5, 2017")

cpSPL17.8 <- ggplot(data =cp17.8, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 8, 2017")

cpSPL17.35 <- ggplot(data =cp17.35, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 35, 2017")

cpSPL17.40 <- ggplot(data =cp17.40, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 40, 2017")

cpSPL17.32 <- ggplot(data =cp17.32, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 32, 2017")

cpSPLMF17 <- plot_grid(cpSPL17.5, cpSPL17.8, cpSPL17.35, cpSPL17.40, cpSPL17.32, nrow = 5, ncol = 1, align = "v")
cpSPLMF17

```


**Total Deployment All Sites, 2018**

```{r combo hf mf site breakdown, echo = FALSE}

#splitting this by site - 2018
cp18.5 <- filter(SPL.both18, Site == "5")
cp18.8 <- filter(SPL.both18, Site == "8")
cp18.32 <- filter(SPL.both18, Site == "32")
cp18.35 <- filter(SPL.both18, Site == "35")
cp18.40 <- filter(SPL.both18, Site == "40")

#renaming the columns
names(cp18.5) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")
names(cp18.8) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")
names(cp18.32) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")
names(cp18.35) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")
names(cp18.40) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")

#comparing between sites for entire deployment
full.SPL18 <- ggplot(data =SPL.both18, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = Site)) + geom_point(aes(y = SPL_HF, color = Site)) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("MF and HF SPL total deployment, 2018")
full.SPL18

```

**Total Deployment Site Breakdown, 2018**

```{r combo site breakdown total deployment 2018, fig.width = 15, fig.height = 20, echo = FALSE}
cpSPL18.5 <- ggplot(data =cp18.5, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 5, 2018")

cpSPL18.8 <- ggplot(data =cp18.8, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 8, 2018")

cpSPL18.35 <- ggplot(data =cp18.35, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 35, 2018")

cpSPL18.40 <- ggplot(data =cp18.40, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 40, 2018")

cpSPL18.32 <- ggplot(data =cp18.32, aes(x=datetime)) + 
  geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) +
  theme(axis.text.x = element_text(angle = 90)) + scale_x_datetime(date_breaks = "1 day") + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Combo Plot Site 32, 2018")

cpSPLMF18 <- plot_grid(cpSPL18.5, cpSPL18.8, cpSPL18.35, cpSPL18.40, cpSPL18.32, nrow = 5, ncol = 1, align = "v")
cpSPLMF18

```

### Combo Plots - Diurnal Patterns

**Diurnal Pattern All Sites, 2017**

```{r combo diurnal pattern, echo = FALSE}

#comparing between sites for 1 day
day.SPL17 <- ggplot(data = SPL.both17, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = Site)) + geom_point(aes(y = SPL_HF, color = Site)) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, 2017")
day.SPL17

```

**Diurnal Pattern Site Breakdown, 2017**

```{r diurnal combo site breakdown 2017, fig.width = 15, fig.height = 20, echo = FALSE}

day.SPL17.5 <- ggplot(data = cp17.5, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 5, 2017")

day.SPL17.8 <- ggplot(data = cp17.8, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 8, 2017")

day.SPL17.35 <- ggplot(data = cp17.35, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 35, 2017")

day.SPL17.40 <- ggplot(data = cp17.40, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 40, 2017")

day.SPL17.32 <- ggplot(data = cp17.32, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 32, 2017")


cp.dSPLMF17 <- plot_grid(day.SPL17.5, day.SPL17.8, day.SPL17.35, day.SPL17.40, day.SPL17.32, nrow = 5, ncol = 1, align = "v")
cp.dSPLMF17

```


**Diurnal Patterns All Sites, 2018**

```{r combo diurnal pattern 2018, echo = FALSE}

#comparing between sites for 1 day
day.SPL18 <- ggplot(data = SPL.both18, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = Site)) + geom_point(aes(y = SPL_HF, color = Site)) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, 2018")
day.SPL18

```


**Diurnal Pattern Site Breakdown, 2018**

```{r combo site breakdown 2018, fig.width = 15, fig.height = 20, echo = FALSE}

day.SPL18.5 <- ggplot(data = cp18.5, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 5, 2018")

day.SPL18.8 <- ggplot(data = cp18.8, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 8, 2018")

day.SPL18.35 <- ggplot(data = cp18.35, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 35, 2018")

day.SPL18.40 <- ggplot(data = cp18.40, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 40, 2018")

day.SPL18.32 <- ggplot(data = cp18.32, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Site 32, 2018")


cp.dSPLMF18 <- plot_grid(day.SPL18.5, day.SPL18.8, day.SPL18.35, day.SPL18.40, day.SPL18.32, nrow = 5, ncol = 1, align = "v")
cp.dSPLMF18

```

**Diurnal Pattern, Only using 4 time point subset - 2017**

While I know these averages aren't accurate - SPL is log scaled, I just wanted to see the breakdown

```{r combo 4 time subset 2017, echo = FALSE}

#subsetting 4 times
SPL.both17.3 <- filter(SPL.both17, Time == "03:00")
SPL.both17.9 <- filter(SPL.both17, Time == "09:00")
SPL.both17.15 <- filter(SPL.both17, Time == "15:00")
SPL.both17.21 <- filter(SPL.both17, Time == "21:00")

#binding above dataframes together
SPL.both17.TS <- rbind(SPL.both17.3, SPL.both17.9, SPL.both17.15, SPL.both17.21)

#renaming columns
names(SPL.both17.TS) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")

#making plot
day.SPL17.TS <- ggplot(data = SPL.both17.TS, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Time subset, 2017")
day.SPL17.TS


#taking average and calculating confidence intervals for sites
high.av <- aggregate(SPL_HF ~ Time, SPL.both17.TS, mean)
low.av <- aggregate(SPL_MF ~ Time, SPL.both17.TS, mean)

high.se <- aggregate(SPL_HF ~ Time, SPL.both17.TS, function(x) sd(x)/sqrt(length(x)))
high.av$SE <- high.se$SPL_HF
high.av$U.SE <- high.av$SPL_HF + high.av$SE
high.av$L.SE <- high.av$SPL_HF - high.av$SE


low.se <- aggregate(SPL_MF ~ Time, SPL.both17.TS, function(x) sd(x)/sqrt(length(x)))
low.av$SE <- low.se$SPL_MF
low.av$U.SE <- low.av$SPL_MF + low.av$SE
low.av$L.SE <- low.av$SPL_MF - low.av$SE




hftime17.CI <- ggplot(high.av, aes(Time, SPL_HF)) + 
  geom_errorbar(aes(ymin = L.SE, ymax = U.SE), color = "black", width = 0) +
  geom_point(aes(fill = Time), color = "black", pch = 21, size = 6) +
  labs(x = "Time", y = "SPL_HF", title = "SPL_HF at 4 studied time points, 2017")
hftime17.CI

mftime17.CI <- ggplot(low.av, aes(Time, SPL_MF)) + 
  geom_errorbar(aes(ymin = L.SE, ymax = U.SE), color = "black", width = 0) +
  geom_point(aes(fill = Time), color = "black", pch = 21, size = 6) +
  labs(x = "Time", y = "SPL_MF", title = "SPL_MF at 4 studied time points, 2017")
mftime17.CI
```

**Diurnal Pattern, Only using 4 time point subset - 2018**

While I know these averages aren't accurate - SPL is log scaled, I just wanted to see the breakdown

```{r combo 4 time subset 2018, echo = FALSE}

#subsetting 4 times
SPL.both18.3 <- filter(SPL.both18, Time == "03:00")
SPL.both18.9 <- filter(SPL.both18, Time == "09:00")
SPL.both18.15 <- filter(SPL.both18, Time == "15:00")
SPL.both18.21 <- filter(SPL.both18, Time == "21:00")

#binding above dataframes together
SPL.both18.TS <- rbind(SPL.both18.3, SPL.both18.9, SPL.both18.15, SPL.both18.21)

#renaming columns
names(SPL.both18.TS) <- c("Date", "Time", "SPL_MF", "Site", "datetime", "SPL_HF")

#making plot
day.SPL18.TS <- ggplot(data = SPL.both18.TS, aes(x= Time)) + geom_point(aes(y = SPL_MF, color = "green4")) + geom_point(aes(y = SPL_HF, color = "orange3")) + theme(axis.text.x = element_text(angle = 90)) + ylab("SPL")+ ggtitle("MF and HF SPL diurnal pattern, Time subset, 2018")
day.SPL18.TS


#taking average and calculating confidence intervals for sites
high.av <- aggregate(SPL_HF ~ Time, SPL.both18.TS, mean)
low.av <- aggregate(SPL_MF ~ Time, SPL.both18.TS, mean)

high.se <- aggregate(SPL_HF ~ Time, SPL.both18.TS, function(x) sd(x)/sqrt(length(x)))
high.av$SE <- high.se$SPL_HF
high.av$U.SE <- high.av$SPL_HF + high.av$SE
high.av$L.SE <- high.av$SPL_HF - high.av$SE


low.se <- aggregate(SPL_MF ~ Time, SPL.both18.TS, function(x) sd(x)/sqrt(length(x)))
low.av$SE <- low.se$SPL_MF
low.av$U.SE <- low.av$SPL_MF + low.av$SE
low.av$L.SE <- low.av$SPL_MF - low.av$SE




hftime18.CI <- ggplot(high.av, aes(Time, SPL_HF)) + 
  geom_errorbar(aes(ymin = L.SE, ymax = U.SE), color = "black", width = 0) +
  geom_point(aes(fill = Time), color = "black", pch = 21, size = 6) +
  labs(x = "Time", y = "SPL_HF", title = "SPL_HF at 4 studied time points, 2018")
hftime18.CI

mftime18.CI <- ggplot(low.av, aes(Time, SPL_MF)) + 
  geom_errorbar(aes(ymin = L.SE, ymax = U.SE), color = "black", width = 0) +
  geom_point(aes(fill = Time), color = "black", pch = 21, size = 6) +
  labs(x = "Time", y = "SPL_MF", title = "SPL_MF at 4 studied time points, 2018")
mftime18.CI
```


#Models
**Preliminary Models** Looking into the relationships between biogenic sounds (Knocks/Calls and Snaps) and their frequency spectra (MF SPL/HF SPL) respectively.
##Testing for Normality

```{r normal, echo = TRUE}

shapiro.test(AC.DF1$SPL_Midrange)
qqnorm(AC.DF1$SPL_Midrange)

ks.test(SPLHF.long$SPL_HF, "pnorm", mean=mean(SPLHF.long$SPL_HF), sd=sd(SPLHF.long$SPL_HF))

ks.test(SPLMF.long$SPL_MF, "pnorm", mean=mean(SPLMF.long$SPL_MF), sd=sd(SPLMF.long$SPL_MF))

gamma_test(AC.DF1$SPL_Midrange)
weibull_test(AC.DF1$SPL_Midrange)

gamma_test(AC.DF1$SPL_HF)
weibull_test(AC.DF1$SPL_HF)
```

Don't seem to have a normal distribution here... Working on testing different distributions.  Not sure what the outputs on the gamma or weibull tests mean

##Model 1
Looking at Total Knocks only
SPL MF ~ Tot_Knocks
``` {r model 1, echo = TRUE}

#model 1 looking at Total Knocks only
gfit1 <- lm(SPL_Midrange ~ Tot_Knocks, data = AC.DF1Co)
#gfit1 <- glm(SPL_Midrange ~ Tot_Knocks, data = AC.DF1Co)
summary(gfit1)

par(mfrow = c(2,2))
plot(gfit1)

summary.glm(gfit1)$coefficients

```

##Model 2
Looking at Total Knocks and Number of Long Calls
SPL MF ~ Tot_Knocks + Num_L_Calls
``` {r model 2, echo = TRUE}

#model 1 looking at Total Knocks only
gfit2 <- lm(SPL_Midrange ~ Tot_Knocks + Num_L_calls, data = AC.DF1Co)
#gfit2 <- glm(SPL_Midrange ~ Tot_Knocks + Num_L_calls, data = AC.DF1Co, family = "gamma")
summary(gfit2)

par(mfrow = c(2,2))
plot(gfit2)


#summary.glm(gfit2)$coefficients



```

##Model 3 
Looking at Total Knocks/Number of long calls/Herbivory
SPL MF ~ Tot_Knocks + Num_L_Calls + Num_Herbivory
``` {r model 3, echo = TRUE}

#model 1 looking at Total Knocks only
gfit3 <- glm(SPL_Midrange ~ Tot_Knocks + Num_L_calls + Num_Herbivory, data = AC.DF1, family = Gamma)

summary(gfit3)

par(mfrow = c(2,2))
plot(gfit3)


summary.glm(gfit3)$coefficients

```

##Model 4
Looking at maximal model + site as a random effect
SPL MF ~ Tot_Knocks + Num_L_Calls + Num_Herbivory + (1|Site)
``` {r model 4, echo = TRUE}

#Adding site as a random effect
gfit4 <- lmer(SPL_Midrange ~ Tot_Knocks + Num_L_calls + Num_Herbivory + (1|Site), data = AC.DF1)

summary(gfit4)

```

##Model 4T
Looking at maximal model + site as a random effect + hour as a categorical (NOT ORDINAL)
SPL MF ~ Tot_Knocks + Num_L_Calls + Num_Herbivory + Hour + (1|Site) 
``` {r model 4t, echo = TRUE}

#Adding site as a random effect
gfit4t <- lmer(SPL_Midrange ~ Tot_Knocks + Num_L_calls + Num_Herbivory + Hour + (1|Site), data = AC.DF1)

summary(gfit4t)

```

##Model 4T (ordinal) - centered
Looking at maximal model + site as a random effect + hour as ORDINAL
SPL MF ~ Tot_Knocks + Num_L_Calls + Num_Herbivory + Hour + (1|Site)

``` {r model 4to, echo = TRUE}
#making Hour ordinal
AC.DF1Co$Hour_factor <- factor (AC.DF1$Hour, order = TRUE, levels = c("3", "9", "15", "21"))
AC.DF1Co$Hour_factor
#Adding site as a random effect
gfit4to <- lmer(SPL_Midrange ~ Tot_Knocks + Num_L_calls + Num_Herbivory + Hour_factor + (1|Site), data = AC.DF1Co)

summary(gfit4to)

```

##Model 5T - interactions (centered)
Looking at maximal model + site as a random effect + hour as ORDINAL + interactions between hour and all explanatory
SPL MF ~ Tot_Knocks + Num_L_Calls + Num_Herbivory + Hour + (1|Site)

``` {r model 5to, echo = TRUE}

#Adding site as a random effect
gfit5to <- lmer(SPL_Midrange ~ Tot_Knocks:Hour_factor + Num_L_calls:Hour_factor + Num_Herbivory:Hour_factor + (1|Site), data = AC.DF1Co)

summary(gfit5to)

```


AIC Model selection - removing Site as a random factor so that I can run AIC stepwise 
```{r AIC, echo = TRUE}

gfitlmto <- lm(SPL_Midrange ~ Tot_Knocks + Num_L_calls + Num_Herbivory + Hour_factor, data = AC.DF1)
aicgfitto <- stepAIC(gfitlmto, direction = "backward")

```

##Model 5 - HF SPL and Snaps
Looking at Snaps and their effect on the HF SPL
SPL HF ~ Snaps
Distributions look normal so this is a linear model
``` {r model 5, echo = TRUE}
fit5 <- lm(SPL_HF ~ Snaps, data = AC.DF1)
summary(fit5)

par(mfrow = c(2,2))
plot(fit5)

summary(fit5)$coefficients
````


